# $newloc
!Location handler transitions
!Overhauled by crushboss
if $rating[0] = '': gs '#var_base'
!AddOnn - disabled wizard_mode check to enable in story mode via options menu
if $master_name ! 'Старый Охотник': wizard_mode = 0

!AddOn - master_mood fix for new game
if master_mood['a'] = 0: master_mood['a'] = 0

!AddOn - Version check
$title_fix = 'Jack HF 1.6 by crushboss'
If $game_ver ! $title_fix:
 gs '$addon', 'update', 'full'
End

IF slave_state ! CONST_INT['no_exist']:
 if slave_rate["pride"] < 0 and slave["pride"] <= 0: slave_rate["pride"] = 0
 if slave_rate["instinct"] < 0 and slave["instinct"] <= 0: slave_rate["instinct"] = 0
 if slave_rate["rational"] < 0 and slave["rational"] <= 0: slave_rate["rational"] = 0

 IF slave["selfesteem"] > 0 and slave["virtue"] > 0: 
  slave["virtue"] = 5
  if slave["selfesteem_revealed"] = 0: slave["selfesteem_revealed"] = 1
 END
 IF slave["selfesteem"] < 0 and slave["sin"] > 0: 
  slave["sin"] = 5
  if slave["selfesteem_revealed"] = 0: slave["selfesteem_revealed"] = 1
 END
 if slave["voice"] < 0 and slave_rate["vocal"] > 0: slave_rate["vocal"] = 0 
 if slave["style"] < 0: slave["style"] = 0
 if stock["style"] < 0: stock["style"] = 0
END

!Added behavior and rules for extended rental - crushboss
IF pen ! 1: 
 pet_tentacle = 0
 tentacle_hp = 0
 tentacle_size = 0
 tentacle_state = 0
END

IF pet_tentacle ! 1:
 pet_tentacle = 0
 tentacle_state = 0
 tentacle_hp = 0
 tentacle_size = 0
 else
 if spawn_milked = 0: tentacle_state = 1
 if spawn_milked = 1: tentacle_state = 2
END

IF barn ! 1:
 svine = 0
 else
 svine = 1
END
 
IF dungeon ! 1:
 arachnidSpider = 0
 polypusvermin = 0
 else
 arachnidSpider = 1
 polypusvermin = 1
END

!Add data for extended rental cheat - crushboss 
IF extended_rental_cheat > 0:
 !Extended Rental
 lab = 1
 bouduar = 1
 dungeon = 1
 barn = 1
 bath = 1
 kitchen = 1
 library = 1
 pen = 1
 svine = 1
 arachnidSpider = 1
 polypusvermin = 1
 
 !Estate Interiors
 $study = 'classic'
 $bg['study'] = $interior_study[$study]
 $bg['home_lux'] = $interior_bg[$study]
 $place_info['study'] = $interior_study_info[$study]
 $interior_bg['classic'] = 'study_large'
 $interior_study['classic'] = 'study'
 $interior_study_info['classic'] = '   '
 
 $bed = 'stylish'
 $bg['bedroom'] = $interior_bed[$bed]
 $place_info['bedroom'] = $interior_bed_info[$bed]
 $interior_bed['stylish'] = 'interiors\stylish_bed'
 $interior_bed_info['stylish'] = '   '
 
 $bath = 'gothic'
 $bg['bathroom'] = $interior_bath[$bath]
 $place_info['bathroom'] = $interior_bath_info[$bath]
 $interior_bath['gothic'] = 'interiors\gothic_bath'
 $interior_bath_info['gothic'] = '   '
 
 $dungeon = 'executor'
 $bg['dungeon'] = $interior_dungeon[$dungeon]
 $place_info['dungeon'] = $interior_dungeon_info[$dungeon]
 $interior_dungeon['executor'] = 'interiors\executor_dungeon'
 $interior_dungeon_info['executor'] = '   '
 
 $kitchen = 'basic'
 $bg['kitchen'] = $interior_kitchen[$kitchen]
 $place_info['kitchen'] = $interior_kitchen_info[$kitchen]
 $interior_kitchen['basic'] = 'kitchen'
 $interior_kitchen_info['basic'] = '   '
 
 $lab = 'basic'
 $bg['lab'] = $interior_lab[$lab]
 $place_info['lab'] = $interior_lab_info[$lab]
 $interior_lab['basic'] = 'interiors\basic_lab'
 $interior_lab_info['basic'] = '   '
 
 $bouduar = 'gothic'
 $bg['bouduar'] = $interior_bouduar[$bouduar]
 $place_info['bouduar'] = $interior_bouduar_info[$bouduar]
 $interior_bouduar['gothic'] = 'interiors\gothic_bouduar'
 $interior_bouduar_info['gothic'] = '   '
 extended_rental_cheat -= 1
END

if master_wealth < 4: club_member = 0

!Added Chimera Gem enhancement - crushboss
if chimera_gem_on = 1: master_excitement = 5 & master_excitement_rate = 200

!retain the rules of the last assistant
IF assistant_state ! 1:
 if assistant_cleans_rule = 1: assistant_cleans_rule = 2
 if assistant_cooks_rule = 1: assistant_cooks_rule = 2
 if assistant_washes_rule = 1: assistant_washes_rule = 2
 if assistant_washe_slave_rule = 1: assistant_washe_slave_rule = 2
 if assistant_supervise_rule = 1: assistant_supervise_rule = 2
 if assistant_buy_vegetables = 1: assistant_buy_vegetables = 2
 if assistant_buy_flower = 1: assistant_buy_flower = 2  
 if assistant_buy_spice = 1: assistant_buy_spice = 2
 if assistant_buy_cheese = 1: assistant_buy_cheese = 2
 if assistant_buy_alcohol = 1: assistant_buy_alcohol = 2
 if assistant_buy_eggs = 1: assistant_buy_eggs = 2
 if assistant_buy_milk = 1: assistant_buy_milk = 2
 if assistant_buy_cream = 1: assistant_buy_cream = 2
 if assistant_buy_mince = 1: assistant_buy_mince = 2
 if assistant_buy_meat = 1: assistant_buy_meat = 2
 else
 if assistant_cleans_rule = 2: assistant_cleans_rule = 1
 if assistant_cooks_rule = 2: assistant_cooks_rule = 1
 if assistant_washes_rule = 2: assistant_washes_rule = 1
 if assistant_washe_slave_rule = 2: assistant_washe_slave_rule = 1
 if assistant_supervise_rule = 2: assistant_supervise_rule = 1
 if assistant_buy_vegetables = 2: assistant_buy_vegetables = 1
 if assistant_buy_flower = 2: assistant_buy_flower = 1  
 if assistant_buy_spice = 2: assistant_buy_spice = 1
 if assistant_buy_cheese = 2: assistant_buy_cheese = 1
 if assistant_buy_alcohol = 2: assistant_buy_alcohol = 1
 if assistant_buy_eggs = 2: assistant_buy_eggs = 1
 if assistant_buy_milk = 2: assistant_buy_milk = 1
 if assistant_buy_cream = 2: assistant_buy_cream = 1
 if assistant_buy_mince = 2: assistant_buy_mince = 1
 if assistant_buy_meat = 2: assistant_buy_meat = 1
END

!Variable rule normalization for assistant - crushboss
if assistant_state ! 1 and assistant_account_rule = 1: assistant_account_rule = 0
if assistant_state ! 1 and assistant_alchemist_rule = 1: assistant_alchemist_rule = 0
if assistant_state ! 1 and assistant_cleans_rule = 1: assistant_cleans_rule = 0
if assistant_state ! 1 and assistant_cooks_rule = 1: assistant_cooks_rule = 0
if assistant_state ! 1 and assistant_washes_rule = 1: assistant_washes_rule = 0
if assistant_state ! 1 and assistant_supervise_rule = 1: assistant_supervise_rule = 0
 
if assistant_state = 1 and slave_state = CONST_INT['no_slave']: assistant_alchemist_rule = 1

!Added checks for accounting rules - crushboss
if assistant_account_rule = 0 and slave_account_rule = 0: master_account_rule = 1
IF assistant_account_rule = 1 and assistant_state = 1:
 slave_account_rule = 0
 master_account_rule = 0
END
IF slave_account_rule = 1 and slave_state = CONST_INT['slave_exist']:
 assistant_account_rule = 0
 master_account_rule = 0
END

!Disable Vaginal Balls rule if the correct conditions don''t exist - crushboss
!Most of the slave rule conditions are handled in slave_stat but for various reasons this one requires special handling here
IF v_balls_rule = 1:
 IF inventory['vaginal_balls'] < 1 or virginity < 1:
  v_balls_rule = 0
 END
END

!Fix blank screen bug - crushboss
IF assistant_state ! 1:
 $assistant["wpn"] = 'безоружный'
 $assistant["armor"] = 'без_брони'
 $assistant["scnd"] = ''
 $assistant["back_wpn"] = ''
 $assistant["left_wpn"] = ''
 $assistant["right_wpn"] = ''
 $assistant["arm_wpn"] = ''
 $assistant["leg_wpn"] = ''
 $assistant["cloth"] = 'голая'
END

!Fix blank screen bug - crushboss
if $assistant["wpn"] = '': $assistant["wpn"] = 'безоружный'
if $assistant["armor"] = '': $assistant["armor"] = 'без_брони'
if $assistant["cloth"] = '': $assistant["cloth"] = 'голая'

!Fix for brand reset bug - crushboss
tattoo_brand = slave['brand']

!Reset all slave variables when no slave exists - improved - crushboss
IF slave_state = CONST_INT['no_exist']:
 slave = 0
 slave["nul"] = 0
 slave_name = ''
 slave_sleep_condition = 0 
 slave_food_type = 0
 slave_eats_remains = 0
 slave_ration = 0
 slave_food_portion = 0
 vitamin = 0
 silence_rule = 0
 master_rule = 0
 rule_masturbation = 0
 orgasm_prohibited = 0
 shit_prohibited = 0
 pet_rule = 0
 blowjob_rule = 0
 pissuar_rule = 0
 toilet_rule = 0
 slave_cleans_rule = 0
 slave_cooks_rule = 0
 slave_washes_rule = 0
 slave_tentacle_rule = 0
 slave_account_rule = 0
 v_balls_rule = 0
 force_rules = 0
 rules_broken = 0
 prise_promised = 0
 prise_level = 0
 prise_potence = 0
 prise_cost = 0
 prise_succes = 0
 slave_fights_back = 0
 gift_promised = 0
 slave["pain_treat"] = 0
 slave["virtue"] = 0
 slave["sin"] = 0
 slave['brand'] = 0
 slave['has_ride_win'] = 0
 tattoo_brand = 0
 abandon_treat = 0
 death_treat = 0
 preset = 0
 slave['on_love_drug'] = 0
 date_succes = 0
 succes = 0
 angst_rise = 0
 moral_app = 0
 moral_basis = 0
 moral_boost = 0
 slave_fights_back = 0
 slave_escape = 0
 slave_attack = 0
 menstruation = 0
 slave_suicide = 0
 slave_died = 0
 rules_broken_message = 0
 rules_broken_sin = 0
 res = 0
 diligence = 0
 repulse = 0
 complex_repulse = 0
 cheer_effect = 0
 cheer_rate = 0
 reasoning_effect = 0
 reasoning_rate = 0 
 sin_gained = 0
 slave_well_rested = 0
 free_time = 0
 rules_count = 0
 daily_reward_count = 0
 rules_broken = 0
 num_rules_broken = 0
 num_rules_wanttobreak = 0
 slave_will_masturbate = 0
 slave_masturbating_anyway = 0
 silence_rule_res = 0
 master_rule_res = 0
 shit_prohibited_res = 0
 pet_rule_res = 0
 blowjob_rule_res = 0
 pissuar_rule_res = 0
 toilet_rule_res = 0
 v_balls_rule_res = 0
 slave['age_count'] = 0
 iwanttobreakbutcant_silence_rule = 0
 iwanttobreakbutcant_master_rule = 0
 iwanttobreakbutcant_shit_prohibited = 0
 iwanttobreakbutcant_pet_rule = 0
 iwanttobreakbutcant_blowjob_rule = 0
 iwanttobreakbutcant_pissuar_rule = 0
 iwanttobreakbutcant_toilet_rule = 0
 iwanttobreakbutcant_v_balls = 0
 unenforced_silence_rule_broken = 0
 unenforced_master_rule_broken = 0
 unenforced_shit_prohibited_broken = 0
 unenforced_pet_rule_broken = 0
 unenforced_blowjob_rule_broken = 0
 unenforced_pissuar_rule_broken = 0
 unenforced_toilet_rule_broken = 0
 unenforced_v_balls_rule_broken = 0
 shameful = 0
 painful = 0
 disgusting = 0
 lesbian = 0
 darkness = 0
 bloody = 0
 fire_based = 0
 water_based = 0
 vermin_based = 0
 deprivation = 0
 abuse = 0	
 compassion = 0
 sensitivity_threshold = 6
 starvation_warning = 0
 comforting = 0
 sweet = 0
 luxury = 0
 flattering = 0
 everlasting = 0
 sex_acceptance = 0
 erotic_stimulation = 0
 final_stimulation = 0
 ejaculation_intensity = 0
 sex_ability = 0
 sex_quality = 0
 orgastic = 0
 orgasm_description = 0    
 talent_bonus = 0
 torture_skill = 0
 torture_intensity = 0
 fear_force = 0
 fear_rised = 0
 fear_resistance = 0
 riser = 0
 rise_difficulty = 0
 rise_modifer = 0
 slave_power = 0
 master_power = 0
 damage = 0
 bruising = 0
 scarification = 0
 noresist = 0
 futile_threat = 0
 easy_for_master = 0
 slave_exhaustion_fainted = 0
 slave_nearly_fainted = 0
 slave_stamina_fainted = 0
 sententia_veritas = 0
 magna_magnifika = 0
 cruciato = 0
 killvar 'slave'
 killvar '$slave' 
 killvar 'slave_rate'
 killvar 'slave_inventory'
 killvar '$slave_inventory'
 killvar 'slave_specialisation'
 killvar 'already_done_today'
 killvar 'already_done_curslave'
 killvar 'already_gain_virtue'
 killvar 'sex'
 killvar 'sex_done_today'
 killvar 'sex_done_thisperson'
 killvar 'today_sex_curslave'
 killvar 'already_sex_curslave'
 $slave["wpn"] = 'безоружный'
 $slave["armor"] = 'без_брони'
 $slave["scnd"] = ''
 $slave["back_wpn"] = ''
 $slave["left_wpn"] = ''
 $slave["right_wpn"] = ''
 $slave["arm_wpn"] = ''
 $slave["leg_wpn"] = ''
 $slave["cloth"] = 'голая'
END

!Fix blank screen bug - crushboss
if $slave["wpn"] = '': $slave["wpn"] = 'безоружный'
if $slave["armor"] = '': $slave["armor"] = 'без_брони'
if $slave["cloth"] = '': $slave["cloth"] = 'голая' 

!reset items that will be re-calculated further down in $newloc
slave['slave_collar'] = 0
slave['wig'] = 0
assistant['slave_collar'] = 0
assistant['wig'] = 0

if master_half_action > 1: master_half_action = 0
if slave['half_action'] > 1: slave['half_action'] = 0

!counting home prestige 
$house_prestige = estate_prestige[$estate] + interior_prestige[$study] + interior_prestige[$bed] + interior_prestige[$bath] + interior_prestige[$kitchen]

!lillimerge: assistant cloths bonus
!counting assistant equip bonuses
assistant_rate["style"] = 0
assistant_rate["exotic_bonus"] = 0 
assistant["ex_plus"] = 0
assistant["st_plus"] = 0
assistant_item = 1
dynamic $item_property[$assistant["armor"]]
dynamic $item_property[$assistant["cloth"]]
dynamic $item_property[$assistant["earrings"]]
dynamic $item_property[$assistant["collar"]]
dynamic $item_property[$assistant["headband"]]
dynamic $item_property[$assistant["gloves"]]
dynamic $item_property[$assistant["nipplerings"]]
dynamic $item_property[$assistant["clitring"]]
dynamic $item_property[$assistant["boots"]]
dynamic $item_property[$assistant["ring_left"]]
dynamic $item_property[$assistant["ring_right"]]
dynamic $item_property[$assistant["naval"]]
dynamic $item_property[$assistant["tongue"]]
assistant_item = 0

!counting slave equip bonuses
slave_rate["style"] = 0
slave_rate["exotic_bonus"] = 0 
slave["ex_plus"] = 0
slave["st_plus"] = 0
killvar 'learn_bonus'
killvar 'daily_bonus'
dynamic $item_property[$slave["armor"]]
dynamic $item_property[$slave["cloth"]]
dynamic $item_property[$slave["earrings"]]
dynamic $item_property[$slave["collar"]]
dynamic $item_property[$slave["headband"]]
dynamic $item_property[$slave["gloves"]]
dynamic $item_property[$slave["nipplerings"]]
dynamic $item_property[$slave["clitring"]]
dynamic $item_property[$slave["boots"]]
dynamic $item_property[$slave["ring_left"]]
dynamic $item_property[$slave["ring_right"]]
dynamic $item_property[$slave["naval"]]
dynamic $item_property[$slave["tongue"]]
IF daily_bonus["mood"] <= 0:
 slave['pos_clothes'] = 0
END

!Added bull ring enhancement - crushboss
if bull_ring_on = 1 and master_energy < 0: master_energy = 0

master_style = style_modifer[$master_cloth]
if master_visage > 0: master_style += 1
if master_haircut > 0: master_style += 1
if master_str > 3: master_style += 1
if master_mood > 0: master_style += 1
if master_mood < 0: master_style -= 1
if master_energy > 0: master_style += 1
if master_energy < 0: master_style -= 1
master_style -= master_hygiene - 1
if master_style < 0: master_style = 0
if master_style > 5: master_style = 5

!Calculate attributes for slave, assistant, and master - overhauled - crushboss
gs '$calculate_attributes'

!Beginning of slave checks - crushboss
IF slave_state ! CONST_INT['no_exist']:
!exotic and style
if slave["makeup"] > 0: slave["makeup_demo"] = 1
IF slave["age"] = CONST_INT['loli_age']:
 slave["epilation"] = 100
 if slave["makeup"] = 0: slave["makeup"] = 2
END

!Set base exotic rating after slave creation
IF slave["echeck"] = 0:
 slave["echeck"] = 1
 if slave["exotic"] = 1: slave["base_exotic"] = 1
 if slave["exotic"] = 2: slave["base_exotic"] = 2
 if slave["exotic"] = 3: slave["base_exotic"] = 3
 if slave["exotic"] = 4: slave["base_exotic"] = 4
 if slave["exotic"] = 5: slave["base_exotic"] = 5
END

IF slave["base_exotic"] > 0: 
  slave["exotic"] = slave["base_exotic"]
  else
  slave["exotic"] = 0
END

!characteristic alignment for slave - crushboss
if slave["beauty"] > 5: slave["beauty"] = 5
if slave["beauty"] < 0: slave["beauty"] = 0
if slave["stamina"] > 5: slave["stamina"] = 5
if slave["stamina"] < 0: slave["stamina"] = 0
if slave["sensitivity"] > 5: slave["sensitivity"] = 5
if slave["sensitivity"] < 0: slave["sensitivity"] = 0
if slave["temper"] > 5: slave["temper"] = 5
if slave["temper"] < 0: slave["temper"] = 0
if slave["pride"] > 5: slave["pride"] = 5
if slave["pride"] < 0: slave["pride"] = 0
if slave["ego"] > 5: slave["ego"] = 5
if slave["ego"] < 0: slave["ego"] = 0
if slave["intellect"] > 5: slave["intellect"] = 5
if slave["intellect"] < 0: slave["intellect"] = 0
if slave["style"] > 5: slave["style"] = 5
if slave["style"] < 0: slave["style"] = 0
if slave["exotic"] > 5: slave["exotic"] = 5
if slave["exotic"] < 0: slave["exotic"] = 0
if slave["fat"] > 5: slave["fat"] = 5
if slave["fat"] < 0: slave["fat"] = 0
if slave["fame"] > 5: slave["fame"] = 5
if slave["fame"] < 0: slave["fame"] = 0
if slave["custom"] > 5: slave["custom"] = 5
if slave["custom"] < 0: slave["custom"] = 0
if slave["moral"] > 5: slave["moral"] = 5
if slave["moral"] < 0: slave["moral"] = 0
if slave["rational"] > 5: slave["rational"] = 5
if slave["rational"] < 0: slave["rational"] = 0
if slave["instinct"] > 5: slave["instinct"] = 5
if slave["instinct"] < 0: slave["instinct"] = 0
if slave["service"] > 5: slave["service"] = 5
if slave["expression"] > 5: slave["expression"] = 5
if slave["nurse"] > 5: slave["nurse"] = 5
if slave["cook"] > 5: slave["cook"] = 5
if slave["gladiatrix"] > 5: slave["gladiatrix"] = 5
if slave["enchanter"] > 5: slave["enchanter"] = 5
if slave["vocal"] > 5: slave["vocal"] = 5
if slave["music"] > 5: slave["music"] = 5
if slave["callisthenics"] > 5: slave["callisthenics"] = 5
if slave["secretary"] > 5: slave["secretary"] = 5
if slave["dressage"] > 5: slave["dressage"] = 5
if slave["pet"] > 5: slave["pet"] = 5
if slave["sub_vaginal"] > 5: slave["sub_vaginal"] = 5
if slave["sub_fisting"] > 5: slave["sub_fisting"] = 5
if slave["sub_threesome"] > 5: slave["sub_threesome"] = 5
if slave["sub_dp"] > 5: slave["sub_dp"] = 5
if slave["sub_tp"] > 5: slave["sub_tp"] = 5
if slave["sub_gangbang"] > 5: slave["sub_gangbang"] = 5
if slave["sub_zoosex"] > 5: slave["sub_zoosex"] = 5
if slave["sub_bestiality"] > 5: slave["sub_bestiality"] = 5
if slave["sub_horse"] > 5: slave["sub_horse"] = 5
if slave["sub_tentacles"] > 5: slave["sub_tentacles"] = 5
if slave["sub_arachnidspider"] > 5: slave["sub_arachnidspider"] = 5
if slave["sub_polypusvermin"] > 5: slave["sub_polypusvermin"] = 5
if slave["sub_hug"] > 5: slave["sub_hug"] = 5
if slave["sub_kiss"] > 5: slave["sub_kiss"] = 5
if slave["sub_bj"] > 5: slave["sub_bj"] = 5
if slave["sub_vaginal"] > 5: slave["sub_vaginal"] = 5
if slave["sub_anal"] > 5: slave["sub_anal"] = 5
if slave["sub_exhibit"] > 5: slave["sub_exhibit"] = 5
if slave["sub_humiliation"] > 5: slave["sub_humiliation"] = 5
if slave["sub_hj"] > 5: slave["sub_hj"] = 5
if slave["sub_fj"] > 5: slave["sub_fj"] = 5
if slave["sub_pazuri"] > 5: slave["sub_pazuri"] = 5
if slave["sub_thongue"] > 5: slave["sub_thongue"] = 5
if slave["sub_dt"] > 5: slave["sub_dt"] = 5
if slave["sub_asslik"] > 5: slave["sub_asslik"] = 5
if slave["anal_stretch"] > 5: slave["anal_stretch"] = 5
if slave["sub_seduce"] > 5: slave["sub_seduce"] = 5
if slave["sub_masturbation"] > 5: slave["sub_masturbation"] = 5
if slave["sub_dildo"] > 5: slave["sub_dildo"] = 5
if slave["sub_enema"] > 5: slave["sub_enema"] = 5
if slave["sub_mazo"] > 5: slave["sub_mazo"] = 5
if slave["sub_selfpain"] > 5: slave["sub_selfpain"] = 5
if slave["sub_piss"] > 5: slave["sub_piss"] = 5
if slave["sub_kopro"] > 5: slave["sub_kopro"] = 5
if slave["sub_bukake"] > 5: slave["sub_bukake"] = 5

if slave["bruises"] > 5: slave["bruises"] = 5
if slave["bruises"] < 0: slave["bruises"] = 0
if slave["scares"] > 5: slave["scares"] = 5
if slave["scares"] < 0: slave["scares"] = 0
if slave["fear"] > 5: slave["fear"] = 5
if slave["fear"] < 0: slave["fear"] = 0
if slave["angst"] > 5: slave["angst"] = 5
if slave["angst"] < 0: slave["angst"] = 0
if slave["spoil"] > 5: slave["spoil"] = 5
if slave["spoil"] < 0: slave["spoil"] = 0
if slave["spoil"] = 0 and slave_rate["spoil"] < -10: slave_rate["spoil"] = -10
if slave["arousal"] > 5: slave["arousal"] = 5
if slave["arousal"] = 5 and slave_rate["arousal"] > 200: slave_rate["arousal"] = 200
if slave["arousal"] < 0: slave["arousal"] = 0
if slave["hygiene"] > 5: slave["hygiene"] = 5
if slave["hygiene"] < 0: slave["hygiene"] = 0
if slave["energy"] < -5: slave["energy"] = -5
if slave["energy"] > 5: slave["energy"] = 5

if slave['ill'] < 0: slave['ill'] = 0
if slave['ill'] > 7: slave['ill'] = 7
if slave['issues'] < 0: slave['issues'] = 0
if slave['issues'] > 5: slave['issues'] = 5
if slave['reabilitation'] < 0: slave['reabilitation'] = 0
if slave['reabilitation'] > 30: slave['reabilitation'] = 30
if slave["metabolism"] < 1: slave["metabolism"] = 1
if slave["metabolism"] > 5: slave["metabolism"] = 5

if slave['pregnant'] = 0 and slave['parasite'] = 0: slave["pregnant_revealed"] = 0

if slave["energy"] > slave["stamina"]: slave["energy"] = slave["stamina"]

IF slave_state = CONST_INT['slave_exist'] and slave_rate["exotic"] <= 0:
 if slave["exotic"] = 1 and slave_rate["exotic"] < 10: slave_rate["exotic"] = 10
 if slave["exotic"] = 2 and slave_rate["exotic"] < 20: slave_rate["exotic"] = 20
 if slave["exotic"] = 3 and slave_rate["exotic"] < 60: slave_rate["exotic"] = 60
 if slave["exotic"] = 4 and slave_rate["exotic"] < 80: slave_rate["exotic"] = 80
 if slave["exotic"] = 5 and slave_rate["exotic"] < 120: slave_rate["exotic"] = 120
END

if slave_rate["exotic"] + slave_rate["exotic_bonus"] >= 10: slave["exotic"] = 1
if slave_rate["exotic"] + slave_rate["exotic_bonus"] >= 20: slave["exotic"] = 2
if slave_rate["exotic"] + slave_rate["exotic_bonus"] >= 60: slave["exotic"] = 3
if slave_rate["exotic"] + slave_rate["exotic_bonus"] >= 80: slave["exotic"] = 4
if slave_rate["exotic"] + slave_rate["exotic_bonus"] >= 120: slave["exotic"] = 5

if slave["virtue"] > 0: eval = slave["virtue"]
if slave["sin"] > 0: eval = 5 + slave["sin"]
if slave["sin"] = 0 and slave["virtue"] = 0: eval = 0

!impact scars and bruises on beauty
!determination of the impact
if slave["scares"] = 0: slave["bscares"] = 0
if slave["scares"] = 1: slave["bscares"] = 5
if slave["scares"] = 2: slave["bscares"] = 10
if slave["scares"] = 3: slave["bscares"] = 30
if slave["scares"] = 4: slave["bscares"] = 60
if slave["scares"] = 5: slave["bscares"] = 80

if slave["bruises"] = 0: slave["bbruises"] = 0
if slave["bruises"] = 1: slave["bbruises"] = 5
if slave["bruises"] = 2: slave["bbruises"] = 10
if slave["bruises"] = 3: slave["bbruises"] = 20
if slave["bruises"] = 4: slave["bbruises"] = 40
if slave["bruises"] = 5: slave["bbruises"] = 60

slave["bsum"] = slave["bscares"] + slave["bbruises"]

!rate starting values
IF slave["bcheck"] = 0:
 slave["bcheck"] = 1
 if slave["beauty"] = 1: slave_rate["beauty"] = 10
 if slave["beauty"] = 2: slave_rate["beauty"] = 20
 if slave["beauty"] = 3: slave_rate["beauty"] = 40
 if slave["beauty"] = 4: slave_rate["beauty"] = 80
 if slave["beauty"] = 5: slave_rate["beauty"] = 160
 if slave_rate["beauty"] >= 10: slave["base_beauty"] = 1
 if slave_rate["beauty"] >= 20: slave["base_beauty"] = 2
 if slave_rate["beauty"] >= 40: slave["base_beauty"] = 3
 if slave_rate["beauty"] >= 80: slave["base_beauty"] = 4
 if slave_rate["beauty"] >= 160: slave["base_beauty"] = 5
END

!calculation of the impact
if slave_rate["beauty"] - slave["bsum"] < 5: slave["beauty"] = 0
if slave_rate["beauty"] - slave["bsum"] >= 5: slave["beauty"] = 1
if slave_rate["beauty"] - slave["bsum"] >= 20: slave["beauty"] = 2
if slave_rate["beauty"] - slave["bsum"] >= 40: slave["beauty"] = 3
if slave_rate["beauty"] - slave["bsum"] >= 80: slave["beauty"] = 4
if slave_rate["beauty"] - slave["bsum"] >= 160: slave["beauty"] = 5

!Fix slave_rate["beauty"] min values - crushboss
if slave["beauty"] = 0 and slave_rate["beauty"] < 0: slave_rate["beauty"] = 0
if slave["beauty"] = 1 and slave_rate["beauty"] < 10: slave_rate["beauty"] = 10
if slave["beauty"] = 2 and slave_rate["beauty"] < 20: slave_rate["beauty"] = 20
if slave["beauty"] = 3 and slave_rate["beauty"] < 40: slave_rate["beauty"] = 40
if slave["beauty"] = 4 and slave_rate["beauty"] < 80: slave_rate["beauty"] = 80
if slave["beauty"] = 5 and slave_rate["beauty"] < 160: slave_rate["beauty"] = 160

if slave["beauty"] = 0: slave["neg_ugly"] = 100
if slave["beauty"] > 0: slave["neg_ugly"] = 0

!Calculate sex skills - Slave - improved - crushboss
if slave["sub_hj"] < slave["petting"]: slave["sub_hj"] = slave["petting"]
slave["petting"] = (slave["sub_hj"] + slave["sub_fj"] + slave["sub_hug"] + slave["sub_pazuri"])/4

if slave["sub_bj"] < slave["sub_dt"]: slave["sub_bj"] = slave["sub_dt"]
if slave["sub_bj"] < slave["sub_bukake"]: slave["sub_bj"] = slave["sub_bukake"]
if slave["sub_bj"] < slave["orgy"]: slave["sub_bj"] = slave["orgy"]
if slave["sub_thongue"] < slave["oral"]: slave["sub_thongue"] = slave["oral"]
slave["oral"] = (slave["sub_kiss"] + slave["sub_thongue"] + slave["sub_bj"] + slave["sub_dt"] + slave["sub_asslik"])/5

if slave["sub_anal"] < slave["anal_stretch"]: slave["sub_anal"] = slave["anal_stretch"]
if slave["sub_anal"] < slave["sub_dp"]: slave["sub_anal"] = slave["sub_dp"]
if slave["sub_anal"] < slave["sub_tp"]: slave["sub_anal"] = slave["sub_tp"]
if slave["sub_anal"] < slave["sub_gangbang"]: slave["sub_anal"] = slave["sub_gangbang"]
if slave["sub_anal"] > slave["anal_stretch"]: slave["anal_stretch"] = slave["sub_anal"] - 1
if slave["sub_anal"] = 1 and slave["anal_stretch"] = 0: slave["anal_stretch"] = 1
if slave["sub_vaginal"] < slave["sub_fisting"]: slave["sub_vaginal"] = slave["sub_fisting"]
if slave["sub_vaginal"] < slave["sub_dp"]: slave["sub_vaginal"] = slave["sub_dp"]
if slave["sub_vaginal"] < slave["sub_tp"]: slave["sub_vaginal"] = slave["sub_tp"]
if slave["sub_vaginal"] < slave["sub_gangbang"]: slave["sub_vaginal"] = slave["sub_gangbang"]
if slave["sub_vaginal"] > slave["sub_fisting"]: slave["sub_fisting"] = slave["sub_vaginal"] - 1
slave["penetration"] = (slave["sub_vaginal"] + slave["sub_anal"] + slave["sub_fisting"] + slave["anal_stretch"])/4

if slave["sub_exhibit"] < slave["roleplay"]: slave["sub_exhibit"] = slave["roleplay"]
if slave["sub_masturbation"] < slave["sub_dildo"]: slave["sub_masturbation"] = slave["sub_dildo"]
slave["roleplay"] = (slave["sub_seduce"] + slave["sub_masturbation"] + slave["sub_dildo"] + slave["sub_exhibit"] + slave["sub_humiliation"])/5

if slave["sub_mazo"] < slave["sub_selfpain"]: slave["sub_mazo"] = slave["sub_selfpain"]
if slave["sub_piss"] < slave["sub_kopro"]: slave["sub_piss"] = slave["sub_kopro"]
slave["fetishism"] = (slave["sub_enema"] + slave["sub_mazo"] + slave["sub_selfpain"] + slave["sub_piss"] + slave["sub_kopro"])/5

if slave["sub_tp"] < slave["sub_gangbang"]: slave["sub_tp"] = slave["sub_gangbang"]
if slave["sub_dp"] < slave["sub_tp"]: slave["sub_dp"] = slave["sub_tp"]
sperm_shwallow = slave["sub_bj"] - 2
if slave["sub_bukake"] < sperm_shwallow: slave["sub_bukake"] = sperm_shwallow
slave["orgy"] = (slave["sub_threesome"] + slave["sub_dp"] + slave["sub_tp"] + slave["sub_gangbang"] + slave["sub_bukake"])/5

slave["xenophily"] = (slave["sub_arachnidspider"] + slave["sub_polypusvermin"] + slave["sub_zoosex"] + slave["sub_bestiality"] + slave["sub_horse"] + slave["sub_tentacles"])/6

!counting style
if slave["makeup"] > 0: slave_rate["style"] += 1
if slave["parfume"] > 0: slave_rate["style"] += 1
if slave["epilation"] > 0: slave_rate["style"] += 1
if slave["manicure"] > 0: slave_rate["style"] += 1
If slave["hairstyle"] < 1 and slave['wig'] > 0: slave["hairstyle"] = 1
if slave["hairstyle"] > 0: slave_rate["style"] += 1

slave["style"] = slave["grace"] - slave["hygiene"]
if slave_rate["style"] > 0: slave["style"] += 1
if slave_rate["style"] > 3: slave["style"] += 1
if slave_rate["style"] > 6: slave["style"] += 1
if slave_rate["style"] > 10: slave["style"] += 1
if slave_rate["style"] > 15: slave["style"] += 1
if slave["style"] > 5: slave["style"] = 5
if slave["style"] < 0: slave["style"] = 0

!counters for formulas
slave["grace_count"] = 0
if slave["grace"] = 1: slave["grace_count"] = 1
if slave["grace"] = -1: slave["grace_count"] = 2

slave["makeup_count"] = 0
if slave["parfume"] > 0: slave["makeup_count"] += 1
if slave["epilation"] > 0: slave["makeup_count"] += 1
if slave["manicure"] > 0: slave["makeup_count"] += 1

slave["piercing_count"] = 0 
if slave["piercings"] >= 1: slave["piercing_count"] = 1 
if slave["piercings"] >= 3: slave["piercing_count"] = 2 
if slave["piercings"] >= 5: slave["piercing_count"] = 3 
if slave["piercings"] >= 7: slave["piercing_count"] = 4 
if slave["piercings"] >= 9: slave["piercing_count"] = 5 

slave["ex_count"] = 0
if slave["ex_plus"] = 1: slave["ex_count"] = 1
if slave["ex_plus"] = 2: slave["ex_count"] = 2
if slave["ex_plus"] = 3: slave["ex_count"] = 3
if slave["ex_plus"] >= 6: slave["ex_count"] = 4
if slave["ex_plus"] >= 9: slave["ex_count"] = 5

slave["st_count"] = 0
if slave["st_plus"] >= 1: slave["st_count"] = 1
if slave["st_plus"] >= 3: slave["st_count"] = 2
if slave["st_plus"] >= 6: slave["st_count"] = 3
if slave["st_plus"] >= 9: slave["st_count"] = 4
if slave["st_plus"] >= 13: slave["st_count"] = 5

!Calculate slave obedience - crushboss
slave["obedience"] = 0
slave_mood_bonus = 0
slave_obedience_bonus = 0
slave_nature = 0
slave_fear_bonus = 0

if slave["mood"] > 0: slave_mood_bonus = 1 + (slave["mood"]/2)
slave_obedience_bonus = 0 + slave["meekness"]
if slave["courage"] = 2: slave["fear"] = 0
if slave["courage"] = 1: slave["fear"] = (slave["fear"]/2)
if slave["courage"] = -1: slave_obedience_bonus += slave["fear"]
slave_nature = (slave["pride"] + slave["temper"] + slave["ego"] + slave["intellect"])
IF slave_nature < 11:
 slave_fear_bonus = (slave["fear"]*2)
 elseif slave_nature = 11:
  slave_fear_bonus = (slave["fear"]*2) + 1
 elseif slave_nature = 12:
  slave_fear_bonus = (slave["fear"]*2) + 2
 elseif slave_nature = 13:
  slave_fear_bonus = (slave["fear"]*2) + 3
 elseif slave_nature = 14:
  slave_fear_bonus = (slave["fear"]*2) + 4  
 elseif slave_nature > 14:
  slave_fear_bonus = (slave["fear"]*3)
END
if slave["age"] = CONST_INT['loli_age']: slave_obedience_bonus += 2
if slave["age"] = CONST_INT['young_age']: slave_obedience_bonus += 1
slave["obedience"] = slave_obedience_bonus + slave_mood_bonus + slave_fear_bonus + (slave["moral"]*2) + (slave["instinct"]*2) + slave["custom"] + slave["rational"] - (slave["spoil"] + (slave['obedience_difficulty']/2) + slave["pride"] + slave["temper"] + slave["ego"] + slave["intellect"])
if $slave_psy_status = 'broken': slave["obedience"] = 100

!Psychological status of slave
$prev_status = $slave_psy_status
$slave_psy_status = $slave_psy_basic

slave_psy_hardness = max (slave["ego"], slave["temper"], slave["spoil"], slave["pride"])
slave_psy_hardness += slave["courage"]
courage = slave_psy_hardness
if slave["mood"] > 0: courage += slave["mood"]
if slave["courage"] = 2: courage = 100

if slave["obedience"] >= slave_psy_hardness: $slave_psy_status = 'docile'

max_motivation = max (slave["moral"],slave["fear"],slave["custom"],slave["rational"],slave["instinct"],slave["mood"],slave["spoil"])
if slave["fear"] = max_motivation and slave["fear"] > courage: $slave_psy_status = 'frightened'

IF slave["obedience"] > 6:
 if slave["moral"] = max_motivation: $slave_psy_status = 'servile'
 if slave["rational"] = max_motivation: $slave_psy_status = 'obedient'
 if slave["instinct"] = max_motivation: $slave_psy_status = 'obedient'
 if slave["custom"] = max_motivation: $slave_psy_status = 'obedient'  
 if $slave_psy_status ! 'frightened' and slave["fear"] = max_motivation: $slave_psy_status = 'obedient'
END

IF slave["obedience"] > 2 and slave["arousal"] > 3 and slave["arousal"] >= slave["moral"] and $slave_psy_status ! 'frightened':
 $slave_psy_status = 'horny'
END

optimism = slave["temper"] + slave["mood"]
IF slave["angst"] > 0 and optimism < 0:
 $slave_psy_status = 'depresive'
END

IF slave["mood"] < 0 and slave["spoil"] > slave["fear"] and slave["spoil"] > slave["moral"]:
 $slave_psy_status = 'hysteric'
END

sanity = slave["ego"] + slave["temper"] + slave["pride"]
IF sanity < 3:
 IF no_mindbreak ! 1:
 $slave_psy_status = 'broken' 
 slave["custom"] = 5
 slave["fear"] = 0
 slave["moral"] = 0
 slave["rational"] = 0
 slave["instinct"] = 0
 slave["obedience"] = 100 
 END
END

if $slave_psy_status ! $prev_status: display_psy_status = 1

!for moodlets
IF $slave_psy_status = 'servile' or $slave_psy_status = 'obedient': 
 slave["status_met"] = 1
 else
 slave["status_met"] = 0
END

if slave["beauty"] > 2 and slave["expression"] > 3 and slave["status_met"] = 1: master_mood['pos_optimism'] = 100
if $slave_psy_status = 'broken': master_mood['neg_grumpy'] = 100 & master_mood['pos_optimism'] = 0
if slave["wounds"] = 0: slave['neg_sick'] = 0

!Calculate slave traits, rank, and stats - crushboss
 gs '$slave_traits'
 gs '$slave_price'
!End of slave checks - END statement is needed - do not remove - crushboss
END

!prisoner
!Psychological status of prisoner
!Beginning of prisoner checks - crushboss
IF prisoner_state > 0:
!Calculate prisoner obedience - crushboss
prisoner["obedience"] = 0
prisoner_mood_bonus = 0
prisoner_obedience_bonus = 0

if prisoner["mood"] > 0: prisoner_mood_bonus = 1 + prisoner["mood"]/2
prisoner_obedience_bonus = 0 + prisoner["meekness"]
if prisoner["courage"] = 2: prisoner["fear"] = 0
if prisoner["courage"] = 1: prisoner["fear"] = prisoner["fear"]/2
if prisoner["courage"] = -1: prisoner_obedience_bonus += prisoner["fear"]
if prisoner["age"] = CONST_INT['loli_age']: prisoner_obedience_bonus += 2
if prisoner["age"] = CONST_INT['young_age']: prisoner_obedience_bonus += 1
prisoner["obedience"] = prisoner_obedience_bonus + prisoner_mood_bonus + (prisoner["moral"]*2) + (prisoner["instinct"]*2) + prisoner["custom"] + prisoner["rational"] + (prisoner["fear"]*3) - (prisoner["spoil"] + (prisoner['obedience_difficulty']/2) + prisoner["pride"] + prisoner["temper"] + prisoner["ego"] + prisoner["intellect"])
if $prisoner_psy_status = 'broken': prisoner["obedience"] = 100

$prev_status = $prisoner_psy_status

$prisoner_psy_status = $prisoner_psy_basic

if prisoner["obedience"] > 4: $prisoner_psy_status = 'soft'

pmax_motivation = max (prisoner["moral"],prisoner["fear"],prisoner["custom"],prisoner["rational"],prisoner["instinct"],prisoner["mood"],prisoner["spoil"])

pcourage = prisoner["ego"] + prisoner["courage"]
if prisoner["mood"] > 0: pcourage += prisoner["mood"]
if prisoner["fear"] = pmax_motivation and prisoner["fear"] > pcourage: $prisoner_psy_status = 'frightened'

IF prisoner["obedience"] > 4:
 if prisoner["moral"] = max_motivation: $prisoner_psy_status = 'servile'
 if prisoner["rational"] = max_motivation: $prisoner_psy_status = 'obedient'
 if prisoner["instinct"] = max_motivation: $prisoner_psy_status = 'obedient'
 if prisoner["custom"] = max_motivation: $prisoner_psy_status = 'obedient'  
 if $prisoner_psy_status ! 'frightened' and prisoner["fear"] = pmax_motivation: $prisoner_psy_status = 'obedient'
END

IF prisoner["obedience"] > 2 and prisoner["arousal"] > 3 and prisoner["arousal"] >= prisoner["moral"] and $prisoner_psy_status ! 'frightened':
 $prisoner_psy_status = 'horny'
END

poptimism = prisoner["temper"] + prisoner["mood"]
IF prisoner["angst"] > 0 and poptimism < 0:
 $prisoner_psy_status = 'depresive'
END

IF prisoner["mood"] < 0 and prisoner["spoil"] > prisoner["fear"] and prisoner["spoil"] > prisoner["moral"]:
 $prisoner_psy_status = 'hysteric'
END

psanity = prisoner["ego"] + prisoner["temper"]
IF psanity < 2:
 IF no_mindbreak ! 1:
 $prisoner_psy_status = 'broken' 
 prisoner["custom"] = 200
 prisoner["fear"] = 0
 prisoner["moral"] = 0
 prisoner["rational"] = 0
 prisoner["instinct"] = 0 
 END
END

!impact scars and bruises on beauty
!determination of the impact
if prisoner["scares"] = 0: prisoner["bscares"] = 0
if prisoner["scares"] = 1: prisoner["bscares"] = 5
if prisoner["scares"] = 2: prisoner["bscares"] = 10
if prisoner["scares"] = 3: prisoner["bscares"] = 30
if prisoner["scares"] = 4: prisoner["bscares"] = 60
if prisoner["scares"] = 5: prisoner["bscares"] = 80

if prisoner["bruises"] = 0: prisoner["bbruises"] = 0
if prisoner["bruises"] = 1: prisoner["bbruises"] = 5
if prisoner["bruises"] = 2: prisoner["bbruises"] = 10
if prisoner["bruises"] = 3: prisoner["bbruises"] = 20
if prisoner["bruises"] = 4: prisoner["bbruises"] = 40
if prisoner["bruises"] = 5: prisoner["bbruises"] = 60

prisoner["bsum"] = prisoner["bscares"] + prisoner["bbruises"]

!rate starting values
IF prisoner["bcheck"] = 0:
 prisoner["bcheck"] = 1
 if prisoner["beauty"] = 1: prisoner_rate["beauty"] = 10
 if prisoner["beauty"] = 2: prisoner_rate["beauty"] = 20
 if prisoner["beauty"] = 3: prisoner_rate["beauty"] = 40
 if prisoner["beauty"] = 4: prisoner_rate["beauty"] = 80
 if prisoner["beauty"] = 5: prisoner_rate["beauty"] = 160
END

!calculation of the impact
if prisoner_rate["beauty"] - prisoner["bsum"] < 5: prisoner["beauty"] = 0
if prisoner_rate["beauty"] - prisoner["bsum"] >= 5: prisoner["beauty"] = 1
if prisoner_rate["beauty"] - prisoner["bsum"] >= 20: prisoner["beauty"] = 2
if prisoner_rate["beauty"] - prisoner["bsum"] >= 40: prisoner["beauty"] = 3
if prisoner_rate["beauty"] - prisoner["bsum"] >= 80: prisoner["beauty"] = 4
if prisoner_rate["beauty"] - prisoner["bsum"] >= 160: prisoner["beauty"] = 5

if prisoner["beauty"] = 0: prisoner["neg_ugly"] = 100
if prisoner["beauty"] > 0: prisoner["neg_ugly"] = 0

!traits for prisoner
$prisoner_features_list = ''
IF prisoner["wounds"] > 0: $prisoner_features_list += '<<$slave_wounds[prisoner["wounds"]]>><BR>'
IF prisoner["scares"] > 0: $prisoner_features_list += '<<$slave_scares[prisoner["scares"]]>><BR>'
IF prisoner["bruises"] > 0: $prisoner_features_list += '<<$slave_bruises[prisoner["bruises"]]>><BR>'
IF master_medic >= 4: if prisoner["starvation"] >= 5: $prisoner_features_list += '<<$prisoner_starvation>><BR>'
!End of prisoner checks - this END statement is needed - crushboss
END

!Beginning of assistant checks - crushboss
IF assistant_state = 1:
!characteristic alignment for assistant - crushboss
if assistant["beauty"] > 5: assistant["beauty"] = 5
if assistant["beauty"] < 0: assistant["beauty"] = 0
if assistant["stamina"] > 5: assistant["stamina"] = 5
if assistant["stamina"] < 0: assistant["stamina"] = 0
if assistant["sensitivity"] > 5: assistant["sensitivity"] = 5
if assistant["sensitivity"] < 0: assistant["sensitivity"] = 0
if assistant["temper"] > 5: assistant["temper"] = 5
if assistant["temper"] < 0: assistant["temper"] = 0
if assistant["pride"] > 5: assistant["pride"] = 5
if assistant["pride"] < 0: assistant["pride"] = 0
if assistant["ego"] > 5: assistant["ego"] = 5
if assistant["ego"] < 0: assistant["ego"] = 0
if assistant["intellect"] > 5: assistant["intellect"] = 5
if assistant["intellect"] < 0: assistant["intellect"] = 0
if assistant["style"] > 5: assistant["style"] = 5
if assistant["style"] < 0: assistant["style"] = 0
if assistant["exotic"] > 5: assistant["exotic"] = 5
if assistant["exotic"] < 0: assistant["exotic"] = 0
if assistant["fat"] > 5: assistant["fat"] = 5
if assistant["fat"] < 0: assistant["fat"] = 0
if assistant["fame"] > 5: assistant["fame"] = 5
if assistant["fame"] < 0: assistant["fame"] = 0
if assistant["custom"] > 5: assistant["custom"] = 5
if assistant["custom"] < 0: assistant["custom"] = 0
if assistant["moral"] > 5: assistant["moral"] = 5
if assistant["moral"] < 0: assistant["moral"] = 0
if assistant["rational"] > 5: assistant["rational"] = 5
if assistant["rational"] < 0: assistant["rational"] = 0
if assistant["instinct"] > 5: assistant["instinct"] = 5
if assistant["instinct"] < 0: assistant["instinct"] = 0
if assistant["service"] > 5: assistant["service"] = 5
if assistant["expression"] > 5: assistant["expression"] = 5
if assistant["nurse"] > 5: assistant["nurse"] = 5
if assistant["cook"] > 5: assistant["cook"] = 5
if assistant["gladiatrix"] > 5: assistant["gladiatrix"] = 5
if assistant["enchanter"] > 5: assistant["enchanter"] = 5
if assistant["vocal"] > 5: assistant["vocal"] = 5
if assistant["music"] > 5: assistant["music"] = 5
if assistant["callisthenics"] > 5: assistant["callisthenics"] = 5
if assistant["secretary"] > 5: assistant["secretary"] = 5
if assistant["dressage"] > 5: assistant["dressage"] = 5
if assistant["pet"] > 5: assistant["pet"] = 5
if assistant["sub_vaginal"] > 5: assistant["sub_vaginal"] = 5
if assistant["sub_fisting"] > 5: assistant["sub_fisting"] = 5
if assistant["sub_threesome"] > 5: assistant["sub_threesome"] = 5
if assistant["sub_dp"] > 5: assistant["sub_dp"] = 5
if assistant["sub_tp"] > 5: assistant["sub_tp"] = 5
if assistant["sub_gangbang"] > 5: assistant["sub_gangbang"] = 5
if assistant["sub_zoosex"] > 5: assistant["sub_zoosex"] = 5
if assistant["sub_bestiality"] > 5: assistant["sub_bestiality"] = 5
if assistant["sub_horse"] > 5: assistant["sub_horse"] = 5
if assistant["sub_tentacles"] > 5: assistant["sub_tentacles"] = 5
if assistant["sub_arachnidspider"] > 5: assistant["sub_arachnidspider"] = 5
if assistant["sub_polypusvermin"] > 5: assistant["sub_polypusvermin"] = 5
if assistant["sub_hug"] > 5: assistant["sub_hug"] = 5
if assistant["sub_kiss"] > 5: assistant["sub_kiss"] = 5
if assistant["sub_bj"] > 5: assistant["sub_bj"] = 5
if assistant["sub_vaginal"] > 5: assistant["sub_vaginal"] = 5
if assistant["sub_anal"] > 5: assistant["sub_anal"] = 5
if assistant["sub_exhibit"] > 5: assistant["sub_exhibit"] = 5
if assistant["sub_humiliation"] > 5: assistant["sub_humiliation"] = 5
if assistant["sub_hj"] > 5: assistant["sub_hj"] = 5
if assistant["sub_fj"] > 5: assistant["sub_fj"] = 5
if assistant["sub_pazuri"] > 5: assistant["sub_pazuri"] = 5
if assistant["sub_thongue"] > 5: assistant["sub_thongue"] = 5
if assistant["sub_dt"] > 5: assistant["sub_dt"] = 5
if assistant["sub_asslik"] > 5: assistant["sub_asslik"] = 5
if assistant["anal_stretch"] > 5: assistant["anal_stretch"] = 5
if assistant["sub_seduce"] > 5: assistant["sub_seduce"] = 5
if assistant["sub_masturbation"] > 5: assistant["sub_masturbation"] = 5
if assistant["sub_dildo"] > 5: assistant["sub_dildo"] = 5
if assistant["sub_enema"] > 5: assistant["sub_enema"] = 5
if assistant["sub_mazo"] > 5: assistant["sub_mazo"] = 5
if assistant["sub_selfpain"] > 5: assistant["sub_selfpain"] = 5
if assistant["sub_piss"] > 5: assistant["sub_piss"] = 5
if assistant["sub_kopro"] > 5: assistant["sub_kopro"] = 5
if assistant["sub_bukake"] > 5: assistant["sub_bukake"] = 5

if assistant["bruises"] > 5: assistant["bruises"] = 5
if assistant["bruises"] < 0: assistant["bruises"] = 0
if assistant["scares"] > 5: assistant["scares"] = 5
if assistant["scares"] < 0: assistant["scares"] = 0
if assistant["fear"] > 5: assistant["fear"] = 5
if assistant["fear"] < 0: assistant["fear"] = 0
if assistant["angst"] > 5: assistant["angst"] = 5
if assistant["angst"] < 0: assistant["angst"] = 0
if assistant["spoil"] > 5: assistant["spoil"] = 5
if assistant["spoil"] < 0: assistant["spoil"] = 0
if assistant["arousal"] > 5: assistant["arousal"] = 5
if assistant["arousal"] = 5 and assistant_rate["arousal"] > 200: assistant_rate["arousal"] = 200
if assistant["arousal"] < 0: assistant["arousal"] = 0
if assistant["hygiene"] > 5: assistant["hygiene"] = 5
if assistant["hygiene"] < 0: assistant["hygiene"] = 0
if assistant["energy"] < -5: assistant["energy"] = -5
if assistant["energy"] > 5: assistant["energy"] = 5

if assistant['ill'] < 0: assistant['ill'] = 0
if assistant['ill'] > 7: assistant['ill'] = 7
if assistant['issues'] < 0: assistant['issues'] = 0
if assistant['issues'] > 5: assistant['issues'] = 5
if assistant['reabilitation'] < 0: assistant['reabilitation'] = 0
if assistant['reabilitation'] > 30: assistant['reabilitation'] = 30
if assistant["metabolism"] < 1: assistant["metabolism"] = 1
if assistant["metabolism"] > 5: assistant["metabolism"] = 5

if assistant['pregnant'] = 0 and assistant['parasite'] = 0: assistant["pregnant_revealed"] = 0

if assistant["energy"] > assistant["stamina"]: assistant["energy"] = assistant["stamina"]

if assistant_rate["exotic"] + assistant_rate["exotic_bonus"] >= 10: assistant["exotic"] = 1
if assistant_rate["exotic"] + assistant_rate["exotic_bonus"] >= 20: assistant["exotic"] = 2
if assistant_rate["exotic"] + assistant_rate["exotic_bonus"] >= 60: assistant["exotic"] = 3
if assistant_rate["exotic"] + assistant_rate["exotic_bonus"] >= 80: assistant["exotic"] = 4
if assistant_rate["exotic"] + assistant_rate["exotic_bonus"] >= 120: assistant["exotic"] = 5

IF assistant_state = 1 and assistant_rate["exotic"] <= 0:
 if assistant["exotic"] = 1 and assistant_rate["exotic"] < 10: assistant_rate["exotic"] = 10
 if assistant["exotic"] = 2 and assistant_rate["exotic"] < 20: assistant_rate["exotic"] = 20
 if assistant["exotic"] = 3 and assistant_rate["exotic"] < 60: assistant_rate["exotic"] = 60
 if assistant["exotic"] = 4 and assistant_rate["exotic"] < 80: assistant_rate["exotic"] = 80
 if assistant["exotic"] = 5 and assistant_rate["exotic"] < 120: assistant_rate["exotic"] = 120
END

!Calculate sex skills - assistant - crushboss
if assistant["sub_hj"] < assistant["petting"]: assistant["sub_hj"] = assistant["petting"]
assistant["petting"] = (assistant["sub_hj"] + assistant["sub_fj"] + assistant["sub_hug"] + assistant["sub_pazuri"])/4

if assistant["sub_bj"] < assistant["orgy"]: assistant["sub_bj"] = assistant["orgy"]
if assistant["sub_bj"] < assistant["sub_dt"]: assistant["sub_bj"] = assistant["sub_dt"]
if assistant["sub_bj"] < assistant["sub_bukake"]: assistant["sub_bj"] = assistant["sub_bukake"]
if assistant["sub_thongue"] < assistant["oral"]: assistant["sub_thongue"] = assistant["oral"]
assistant["oral"] = (assistant["sub_kiss"] + assistant["sub_thongue"] + assistant["sub_bj"] + assistant["sub_dt"] + assistant["sub_asslik"])/5

if assistant["sub_anal"] < assistant["anal_stretch"]: assistant["sub_anal"] = assistant["anal_stretch"]
if assistant["sub_anal"] < assistant["sub_dp"]: assistant["sub_anal"] = assistant["sub_dp"]
if assistant["sub_anal"] < assistant["sub_tp"]: assistant["sub_anal"] = assistant["sub_tp"]
if assistant["sub_anal"] < assistant["sub_gangbang"]: assistant["sub_anal"] = assistant["sub_gangbang"]
if assistant["sub_anal"] > assistant["anal_stretch"]: assistant["anal_stretch"] = assistant["sub_anal"] - 1
if assistant["sub_anal"] = 1 and assistant["anal_stretch"] = 0: assistant["anal_stretch"] = 1
if assistant["sub_vaginal"] < assistant["sub_fisting"]: assistant["sub_vaginal"] = assistant["sub_fisting"]
if assistant["sub_vaginal"] < assistant["sub_dp"]: assistant["sub_vaginal"] = assistant["sub_dp"]
if assistant["sub_vaginal"] < assistant["sub_tp"]: assistant["sub_vaginal"] = assistant["sub_tp"]
if assistant["sub_vaginal"] < assistant["sub_gangbang"]: assistant["sub_vaginal"] = assistant["sub_gangbang"]
if assistant["sub_vaginal"] > assistant["sub_fisting"]: assistant["sub_fisting"] = assistant["sub_vaginal"] - 1
assistant["penetration"] = (assistant["sub_vaginal"] + assistant["sub_anal"] + assistant["sub_fisting"] + assistant["anal_stretch"])/4

if assistant["sub_exhibit"] < assistant["roleplay"]: assistant["sub_exhibit"] = assistant["roleplay"]
if assistant["sub_masturbation"] < assistant["sub_dildo"]: assistant["sub_masturbation"] = assistant["sub_dildo"]
assistant["roleplay"] = (assistant["sub_seduce"] + assistant["sub_masturbation"] + assistant["sub_dildo"] + assistant["sub_exhibit"] + assistant["sub_humiliation"])/5

if assistant["sub_mazo"] < assistant["sub_selfpain"]: assistant["sub_mazo"] = assistant["sub_selfpain"]
if assistant["sub_piss"] < assistant["sub_kopro"]: assistant["sub_piss"] = assistant["sub_kopro"]
assistant["fetishism"] = (assistant["sub_enema"] + assistant["sub_mazo"] + assistant["sub_selfpain"] + assistant["sub_piss"] + assistant["sub_kopro"])/5

if assistant["sub_tp"] < assistant["sub_gangbang"]: assistant["sub_tp"] = assistant["sub_gangbang"]
if assistant["sub_dp"] < assistant["sub_tp"]: assistant["sub_dp"] = assistant["sub_tp"]
assistant_sperm_shwallow = assistant["sub_bj"] - 2
if assistant["sub_bukake"] < assistant_sperm_shwallow: assistant["sub_bukake"] = assistant_sperm_shwallow
assistant["orgy"] = (assistant["sub_threesome"] + assistant["sub_dp"] + assistant["sub_tp"] + assistant["sub_gangbang"] + assistant["sub_bukake"])/5

assistant["xenophily"] = (assistant["sub_arachnidspider"] + assistant["sub_polypusvermin"] + assistant["sub_zoosex"] + assistant["sub_bestiality"] + assistant["sub_horse"] + assistant["sub_tentacles"])/6

!style
!AddOn - assistant style calculation in line with slaves calculation
if assistant["makeup"] > 0: assistant_rate["style"] += 1
if assistant["parfume"] > 0: assistant_rate["style"] += 1
if assistant["epilation"] > 0: assistant_rate["style"] += 1
if assistant["manicure"] > 0: assistant_rate["style"] += 1
IF assistant["hairstyle"] < 1 and assistant['wig'] > 0: assistant["hairstyle"] = 1
if assistant["hairstyle"] > 0: assistant_rate["style"] += 1

assistant["style"] = assistant["grace"] - assistant["hygiene"]
if assistant_rate["style"] > 0: assistant["style"] += 1
if assistant_rate["style"] > 2: assistant["style"] += 1
if assistant_rate["style"] > 5: assistant["style"] += 1
if assistant_rate["style"] > 9: assistant["style"] += 1
if assistant_rate["style"] > 13: assistant["style"] += 1
if assistant["style"] > 5: assistant["style"] = 5
if assistant["style"] < 0: assistant["style"] = 0

!counters for formulas
assistant["grace_count"] = 0
if assistant["grace"] = 1: assistant["grace_count"] = 1
if assistant["grace"] = -1: assistant["grace_count"] = 2

assistant["makeup_count"] = 0
if assistant["parfume"] > 0: assistant["makeup_count"] += 1
if assistant["epilation"] > 0: assistant["makeup_count"] += 1
if assistant["manicure"] > 0: assistant["makeup_count"] += 1

assistant["piercing_count"] = 0 
if assistant["piercings"] >= 1: assistant["piercing_count"] = 1 
if assistant["piercings"] >= 3: assistant["piercing_count"] = 2 
if assistant["piercings"] >= 5: assistant["piercing_count"] = 3 
if assistant["piercings"] >= 7: assistant["piercing_count"] = 4 
if assistant["piercings"] >= 8: assistant["piercing_count"] = 5 

assistant["ex_count"] = 0
if assistant["ex_plus"] = 1: assistant["ex_count"] = 1
if assistant["ex_plus"] = 2: assistant["ex_count"] = 2
if assistant["ex_plus"] = 3: assistant["ex_count"] = 3
if assistant["ex_plus"] >= 4: assistant["ex_count"] = 4
if assistant["ex_plus"] >= 7: assistant["ex_count"] = 5

assistant["st_count"] = 0
if assistant["st_plus"] >= 1: assistant["st_count"] = 1
if assistant["st_plus"] >= 3: assistant["st_count"] = 2
if assistant["st_plus"] >= 6: assistant["st_count"] = 3
if assistant["st_plus"] >= 9: assistant["st_count"] = 4
if assistant["st_plus"] >= 12: assistant["st_count"] = 5

!impact scars and bruises on beauty
!determination of the impact
if assistant["scares"] = 0: assistant["bscares"] = 0
if assistant["scares"] = 1: assistant["bscares"] = 5
if assistant["scares"] = 2: assistant["bscares"] = 10
if assistant["scares"] = 3: assistant["bscares"] = 30
if assistant["scares"] = 4: assistant["bscares"] = 60
if assistant["scares"] = 5: assistant["bscares"] = 80

if assistant["bruises"] = 0: assistant["bbruises"] = 0
if assistant["bruises"] = 1: assistant["bbruises"] = 5
if assistant["bruises"] = 2: assistant["bbruises"] = 10
if assistant["bruises"] = 3: assistant["bbruises"] = 20
if assistant["bruises"] = 4: assistant["bbruises"] = 40
if assistant["bruises"] = 5: assistant["bbruises"] = 60

assistant["bsum"] = assistant["bscares"] + assistant["bbruises"]

!rate starting values
IF assistant["bcheck"] = 0:
 assistant["bcheck"] = 1
 if assistant["beauty"] = 1: assistant_rate["beauty"] = 10
 if assistant["beauty"] = 2: assistant_rate["beauty"] = 20
 if assistant["beauty"] = 3: assistant_rate["beauty"] = 40
 if assistant["beauty"] = 4: assistant_rate["beauty"] = 80
 if assistant["beauty"] = 5: assistant_rate["beauty"] = 160
 if assistant_rate["beauty"] >= 10: assistant["base_beauty"] = 1
 if assistant_rate["beauty"] >= 20: assistant["base_beauty"] = 2
 if assistant_rate["beauty"] >= 40: assistant["base_beauty"] = 3
 if assistant_rate["beauty"] >= 80: assistant["base_beauty"] = 4
 if assistant_rate["beauty"] >= 160: assistant["base_beauty"] = 5 
END

!calculation of the impact
if assistant_rate["beauty"] - assistant["bsum"] < 5: assistant["beauty"] = 0
if assistant_rate["beauty"] - assistant["bsum"] >= 5: assistant["beauty"] = 1
if assistant_rate["beauty"] - assistant["bsum"] >= 20: assistant["beauty"] = 2
if assistant_rate["beauty"] - assistant["bsum"] >= 40: assistant["beauty"] = 3
if assistant_rate["beauty"] - assistant["bsum"] >= 80: assistant["beauty"] = 4
if assistant_rate["beauty"] - assistant["bsum"] >= 160: assistant["beauty"] = 5

!Fix assistant_rate["beauty"] min values - crushboss
if assistant["beauty"] = 0 and assistant_rate["beauty"] < 0: assistant_rate["beauty"] = 0
if assistant["beauty"] = 1 and assistant_rate["beauty"] < 10: assistant_rate["beauty"] = 10
if assistant["beauty"] = 2 and assistant_rate["beauty"] < 20: assistant_rate["beauty"] = 20
if assistant["beauty"] = 3 and assistant_rate["beauty"] < 40: assistant_rate["beauty"] = 40
if assistant["beauty"] = 4 and assistant_rate["beauty"] < 80: assistant_rate["beauty"] = 80
if assistant["beauty"] = 5 and assistant_rate["beauty"] < 160: assistant_rate["beauty"] = 160

if assistant["beauty"] = 0: assistant["neg_ugly"] = 100
if assistant["beauty"] > 0: assistant["neg_ugly"] = 0

!Calculate assistant obedience - crushboss
assistant["obedience"] = 0
assistant_mood_bonus = 0
assistant_obedience_bonus = 0
assistant_nature = 0
assistant_fear_bonus = 0

!Calculate assistant obedience - crushboss
if assistant["mood"] > 0: assistant_mood_bonus = 1 + (assistant["mood"]/2)
assistant_obedience_bonus = 0 + assistant["meekness"]
if assistant["courage"] = 2: assistant["fear"] = 0
if assistant["courage"] = 1: assistant["fear"] = (assistant["fear"]/2)
if assistant["courage"] = -1: assistant_obedience_bonus += assistant["fear"]
assistant_nature = (assistant["pride"] + assistant["temper"] + assistant["ego"] + assistant["intellect"])
IF assistant_nature < 11:
 assistant_fear_bonus = (assistant["fear"]*2)
 elseif assistant_nature = 11:
  assistant_fear_bonus = (assistant["fear"]*2) + 1
 elseif assistant_nature = 12:
  assistant_fear_bonus = (assistant["fear"]*2) + 2
 elseif assistant_nature = 13:
  assistant_fear_bonus = (assistant["fear"]*2) + 3
 elseif assistant_nature = 14:
  assistant_fear_bonus = (assistant["fear"]*2) + 4  
 elseif assistant_nature > 14:
  assistant_fear_bonus = (assistant["fear"]*3)
END
if assistant["age"] = CONST_INT['loli_age']: assistant_obedience_bonus += 2
if assistant["age"] = CONST_INT['young_age']: assistant_obedience_bonus += 1
assistant["obedience"] = assistant_obedience_bonus + assistant_mood_bonus + assistant_fear_bonus + (assistant["moral"]*2) + (assistant["instinct"]*2) + assistant["custom"] + assistant["rational"] - (assistant["spoil"] + (assistant['obedience_difficulty']/2) + assistant["pride"] + assistant["temper"] + assistant["ego"] + assistant["intellect"])
if $assistant_psy_status = 'broken': assistant["obedience"] = 100

!Psychological status of assistant - crushboss
$assistant_prev_status = $assistant_psy_status
$assistant_psy_status = $assistant_psy_basic

assistant_psy_hardness = max (assistant["ego"], assistant["temper"], assistant["spoil"], assistant["pride"])
assistant_psy_hardness += assistant["courage"]
assistant_courage = assistant_psy_hardness
if assistant["mood"] > 0: assistant_courage += assistant["mood"]
if assistant["courage"] = 2: assistant_courage = 100

if assistant["obedience"] >= assistant_psy_hardness: $assistant_psy_status = 'docile'

assistant_max_motivation = max (assistant["moral"],assistant["fear"],assistant["custom"],assistant["rational"],assistant["instinct"],assistant["mood"],assistant["spoil"])
if assistant["fear"] = assistant_max_motivation and assistant["fear"] > assistant_courage: $assistant_psy_status = 'frightened'

IF assistant["obedience"] > 6:
 if assistant["moral"] = assistant_max_motivation: $assistant_psy_status = 'servile'
 if assistant["rational"] = assistant_max_motivation: $assistant_psy_status = 'obedient'
 if assistant["instinct"] = assistant_max_motivation: $assistant_psy_status = 'obedient'
 if assistant["custom"] = assistant_max_motivation: $assistant_psy_status = 'obedient'  
 if $assistant_psy_status ! 'frightened' and assistant["fear"] = assistant_max_motivation: $assistant_psy_status = 'obedient'
END

IF assistant["obedience"] > 2 and assistant["arousal"] > 3 and assistant["arousal"] >= assistant["moral"] and $assistant_psy_status ! 'frightened':
 $assistant_psy_status = 'horny'
END

assistant_optimism = assistant["temper"] + assistant["mood"]
IF assistant["angst"] > 0 and assistant_optimism < 0:
 $assistant_psy_status = 'depresive'
END

IF assistant["mood"] < 0 and assistant["spoil"] > assistant["fear"] and assistant["spoil"] > assistant["moral"]:
 $assistant_psy_status = 'hysteric'
END

assistant_sanity = assistant["ego"] + assistant["temper"] + assistant["pride"]
IF assistant_sanity < 3:
 IF no_mindbreak ! 1:
 $assistant_psy_status = 'broken' 
 assistant["custom"] = 5
 assistant["fear"] = 0
 assistant["moral"] = 0
 assistant["rational"] = 0
 assistant["instinct"] = 0
 assistant["obedience"] = 100 
 END
END

if $assistant_psy_status ! $assistant_prev_status: display_psy_status = 1

!for moodlets
IF $assistant_psy_status = 'servile' or $assistant_psy_status = 'obedient': 
 assistant["status_met"] = 1
 else
 assistant["status_met"] = 0
END

!Calculate assistant traits, rank, and stats - crushboss
 gs '$assistant_traits'
 gs '$assistant_rank_stats'
!End of assistant checks - this END statement is needed - crushboss
END

!Process master, slave, and assistant moodlets - crushboss
gs 'moodlets'

!TRAITS OF FROZEN SLAVES
$iced_features_list = ''
IF iced["brand"] = 0: $iced_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced["wounds"] > 0: $iced_features_list += '<<$slave_wounds[iced["wounds"]]>><BR>'
IF iced["scares"] > 0: $iced_features_list += '<<$slave_scares[iced["scares"]]>><BR>'
IF iced["bruises"] > 0: $iced_features_list += '<<$slave_bruises[iced["bruises"]]>><BR>'
IF iced['reabilitation'] > 0: $iced_features_list += 'Recovery [<<iced["reabilitation"]>>]<BR>'
IF iced_virginity < 2: $iced_features_list += 'Virgin<BR>' 
if iced['fertility'] = -2: $iced_features_list += 'Immature<BR>' 
IF iced['fertility'] = -1: $iced_features_list += 'Sterile<BR>' 
IF iced['fertility'] = 1: $iced_features_list += 'Egglaying<BR>' 
IF iced['pregnant'] = 1 and iced["pregnant_revealed"] > 0: $iced_features_list += 'Pregnant<BR>' 
IF iced['arena_level'] > 4: $iced_features_list += 'Arena champion<BR>'

$iced_1_features_list = ''
IF iced_1["brand"] = 0: $iced_1_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced_1["wounds"] > 0: $iced_1_features_list += '<<$slave_wounds[iced_1["wounds"]]>><BR>'
IF iced_1["scares"] > 0: $iced_1_features_list += '<<$slave_scares[iced_1["scares"]]>><BR>'
IF iced_1["bruises"] > 0: $iced_1_features_list += '<<$slave_bruises[iced_1["bruises"]]>><BR>'
IF iced_1['reabilitation'] > 0: $iced_1_features_list += 'Recovery [<<iced_1["reabilitation"]>>]<BR>'
IF iced_1_virginity < 2: $iced_1_features_list += 'Virgin<BR>' 
if iced_1['fertility'] = -2: $iced_1_features_list += 'Immature<BR>' 
IF iced_1['fertility'] = -1: $iced_1_features_list += 'Sterile<BR>' 
IF iced_1['fertility'] = 1: $iced_1_features_list += 'Egglaying<BR>' 
IF iced_1['pregnant'] = 1 and iced_1["pregnant_revealed"] > 0: $iced_1_features_list += 'Pregnant<BR>' 
IF iced_1['arena_level'] > 4: $iced_1_features_list += 'Arena champion<BR>'

$iced_2_features_list = ''
IF iced_2["brand"] = 0: $iced_2_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced_2["wounds"] > 0: $iced_2_features_list += '<<$slave_wounds[iced_2["wounds"]]>><BR>'
IF iced_2["scares"] > 0: $iced_2_features_list += '<<$slave_scares[iced_2["scares"]]>><BR>'
IF iced_2["bruises"] > 0: $iced_2_features_list += '<<$slave_bruises[iced_2["bruises"]]>><BR>'
IF iced_2['reabilitation'] > 0: $iced_2_features_list += 'Recovery [<<iced_2["reabilitation"]>>]<BR>'
IF iced_2_virginity < 2: $iced_2_features_list += 'Virgin<BR>' 
if iced_2['fertility'] = -2: $iced_2_features_list += 'Immature<BR>' 
IF iced_2['fertility'] = -1: $iced_2_features_list += 'Sterile<BR>' 
IF iced_2['fertility'] = 1: $iced_2_features_list += 'Egglaying<BR>' 
IF iced_2['pregnant'] = 1 and iced_2["pregnant_revealed"] > 0: $iced_2_features_list += 'Pregnant<BR>' 
IF iced_2['arena_level'] > 4: $iced_2_features_list += 'Arena champion<BR>'

$iced_3_features_list = ''
IF iced_3["brand"] = 0: $iced_3_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced_3["wounds"] > 0: $iced_3_features_list += '<<$slave_wounds[iced_3["wounds"]]>><BR>'
IF iced_3["scares"] > 0: $iced_3_features_list += '<<$slave_scares[iced_3["scares"]]>><BR>'
IF iced_3["bruises"] > 0: $iced_3_features_list += '<<$slave_bruises[iced_3["bruises"]]>><BR>'
IF iced_3['reabilitation'] > 0: $iced_3_features_list += 'Recovery [<<iced_3["reabilitation"]>>]<BR>'
IF iced_3_virginity < 2: $iced_3_features_list += 'Virgin<BR>' 
if iced_3['fertility'] = -2: $iced_3_features_list += 'Immature<BR>' 
IF iced_3['fertility'] = -1: $iced_3_features_list += 'Sterile<BR>' 
IF iced_3['fertility'] = 1: $iced_3_features_list += 'Egglaying<BR>' 
IF iced_3['pregnant'] = 1 and iced_3["pregnant_revealed"] > 0: $iced_3_features_list += 'Pregnant<BR>' 
IF iced_3['arena_level'] > 4: $iced_3_features_list += 'Arena champion<BR>'

$iced_4_features_list = ''
IF iced_4["brand"] = 0: $iced_4_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced_4["wounds"] > 0: $iced_4_features_list += '<<$slave_wounds[iced_4["wounds"]]>><BR>'
IF iced_4["scares"] > 0: $iced_4_features_list += '<<$slave_scares[iced_4["scares"]]>><BR>'
IF iced_4["bruises"] > 0: $iced_4_features_list += '<<$slave_bruises[iced_4["bruises"]]>><BR>'
IF iced_4['reabilitation'] > 0: $iced_4_features_list += 'Recovery [<<iced_4["reabilitation"]>>]<BR>'
IF iced_4_virginity < 2: $iced_4_features_list += 'Virgin<BR>' 
if iced_4['fertility'] = -2: $iced_4_features_list += 'Immature<BR>' 
IF iced_4['fertility'] = -1: $iced_4_features_list += 'Sterile<BR>' 
IF iced_4['fertility'] = 1: $iced_4_features_list += 'Egglaying<BR>' 
IF iced_4['pregnant'] = 1 and iced_4["pregnant_revealed"] > 0: $iced_4_features_list += 'Pregnant<BR>' 
IF iced_4['arena_level'] > 4: $iced_4_features_list += 'Arena champion<BR>'

$iced_5_features_list = ''
IF iced_5["brand"] = 0: $iced_5_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced_5["wounds"] > 0: $iced_5_features_list += '<<$slave_wounds[iced_5["wounds"]]>><BR>'
IF iced_5["scares"] > 0: $iced_5_features_list += '<<$slave_scares[iced_5["scares"]]>><BR>'
IF iced_5["bruises"] > 0: $iced_5_features_list += '<<$slave_bruises[iced_5["bruises"]]>><BR>'
IF iced_5['reabilitation'] > 0: $iced_5_features_list += 'Recovery [<<iced_5["reabilitation"]>>]<BR>'
IF iced_5_virginity < 2: $iced_5_features_list += 'Virgin<BR>' 
if iced_5['fertility'] = -2: $iced_5_features_list += 'Immature<BR>' 
IF iced_5['fertility'] = -1: $iced_5_features_list += 'Sterile<BR>' 
IF iced_5['fertility'] = 1: $iced_5_features_list += 'Egglaying<BR>' 
IF iced_5['pregnant'] = 1 and iced_5["pregnant_revealed"] > 0: $iced_5_features_list += 'Pregnant<BR>' 
IF iced_5['arena_level'] > 4: $iced_5_features_list += 'Arena champion<BR>'

$iced_6_features_list = ''
IF iced_6["brand"] = 0: $iced_6_features_list +='<a href = "EXEC: msg $Нет_клейма"><font color="#cd0000">Not branded</font></a><BR>'
IF iced_6["wounds"] > 0: $iced_6_features_list += '<<$slave_wounds[iced_6["wounds"]]>><BR>'
IF iced_6["scares"] > 0: $iced_6_features_list += '<<$slave_scares[iced_6["scares"]]>><BR>'
IF iced_6["bruises"] > 0: $iced_6_features_list += '<<$slave_bruises[iced_6["bruises"]]>><BR>'
IF iced_6['reabilitation'] > 0: $iced_6_features_list += 'Recovery [<<iced_6["reabilitation"]>>]<BR>'
IF iced_6_virginity < 2: $iced_6_features_list += 'Virgin<BR>' 
if iced_6['fertility'] = -2: $iced_6_features_list += 'Immature<BR>' 
IF iced_6['fertility'] = -1: $iced_6_features_list += 'Sterile<BR>' 
IF iced_6['fertility'] = 1: $iced_6_features_list += 'Egglaying<BR>' 
IF iced_6['pregnant'] = 1 and iced_6["pregnant_revealed"] > 0: $iced_6_features_list += 'Pregnant<BR>' 
IF iced_6['arena_level'] > 4: $iced_6_features_list += 'Arena champion<BR>'

if master_wealth < 0: master_wealth = 0
if master_cha < 0: master_cha = 0
if master_hygiene < 0: master_hygiene = 0
if house_mess < 0: house_mess = 0
if slave["voice"] > 0: slave["vocal"] += 1
if slave["vocal"] > 5: slave["vocal"] = 5

восприятие = master_fighter - 1
ловкость = master_fighter - 1
сила = master_fighter - 1

!display indicators - improved - crushboss
gs '$moodlets_account'
master_energy_plus = master_energy
if master_energy_plus < 0: master_energy_plus = 5 - master_energy
master_mood_plus = master_mood
if master_mood_plus < 0: master_mood_plus = 5 - master_mood
if master_excitement < -5: master_excitement = -5
if master_excitement > 5: master_excitement = 5
if master_excitement_rate < -200: master_excitement_rate = -200
if master_excitement_rate > 200: master_excitement_rate = 200
master_excitement_plus = master_excitement
if master_excitement_plus < 0: master_excitement_plus = 5 - master_excitement
if master_excitement_plus > 10: master_excitement_plus = 10
if master_excitement_plus < 0: master_excitement_plus = 0

slave_energy_plus = slave["energy"]
if slave_energy_plus < 0: slave_energy_plus = 5 - slave["energy"]
slave_mood_plus = slave["mood"]
if slave_mood_plus < 0: slave_mood_plus = 5 - slave["mood"]
slave_arousal_plus = slave["arousal"]
if slave_arousal_plus < 0: slave_arousal_plus = 5 - slave["arousal"]

assistant_energy_plus = assistant["energy"]
if assistant_energy_plus < 0: assistant_energy_plus = 5 - assistant["energy"]

prisoner_energy_plus = prisoner["energy"]
if prisoner_energy_plus < 0: prisoner_energy_plus = 5 - prisoner["energy"]
prisoner_mood_plus = prisoner["mood"]
if prisoner_mood_plus < 0: prisoner_mood_plus = 5 - prisoner["mood"]

if cooked_food < 0: cooked_food_plus = 0
if cooked_food > 0: cooked_food_plus = cooked_food

!calculation of fridge free space
frige_items = frige["vegetables"] + frige["flower"] + frige["spice"] + frige["cheese"] + frige["eggs"] + frige["milk"] + frige["cream"] + frige["mince"] + frige["meat"] + frige["virgin_meat"]
frige_space = estate_size[$estate] - frige_items
if spawn_semen > estate_size[$estate]: spawn_semen = estate_size[$estate]

!Calculation of Laboratory free space - $get_lab_space - crushboss
lab_items = lab_store["slime"] + lab_store["kanabis"] + lab_store["koffe"] + lab_store["meth"] + lab_store["opium"] + вакхический_нектар + тонизируюзщий_эликсир + целительный_бальзам + афродизиак + мощный_афодизиак + приворотное_зелье + вода_леты
lab_space = estate_size[$estate] - lab_items

!active quests
$quest_description[1] = "<<$brand_fame[brand_reputation]>><br>
   <<$taurus_fame[faction_fame['taurus']]>><br>
   <<$serpis_fame[faction_fame['serpis']]>><br>
   <<$kamira_fame[faction_fame['kamira']]>><br>
   <<$korvus_fame[faction_fame['korvus']]>><br>

<a href = 'EXEC: quest_description_mode = 0 & gt curloc'>Back</a>"
!CHECK: почему мертвым можно?
IF slave_state > CONST_INT['no_slave']:
 active[$quest[2]] = 1
 else
 active[$quest[2]] = 0
 gs '#quest_base'
END

IF exam_in_progress = 1:
 IF sparks <= 0:
  txt = 1
  lecture = 13
  GT 'demo_intro'
 END
END

!Reflagging full piercing - crushboss
IF slave["niple_piercing"] = 1 and slave["clit_piercing"] = 1 and slave["ear_piercing"] = 1 and slave["thongue_piercing"] = 1 and slave["belly_piercing"] = 1 and slave["nosdril_piercing"] = 1 and slave["nose_piercing"] = 1:
 slave["full_piercing"] = 1
 if slave["piercings"] < 7: slave["piercings"] = 7
 if slave["piercing_count"] < 4: slave["piercing_count"] = 4
END
IF assistant["niple_piercing"] = 1 and assistant["clit_piercing"] = 1 and assistant["ear_piercing"] = 1 and assistant["thongue_piercing"] = 1 and assistant["belly_piercing"] = 1 and assistant["nosdril_piercing"] = 1 and assistant["nose_piercing"] = 1:
 assistant["full_piercing"] = 1
 if assistant["piercings"] < 7: assistant["piercings"] = 7
 if assistant["piercing_count"] < 4: assistant["piercing_count"] = 4
END

!Partrician quest adjustments - crushboss
IF faction_fame['serpis'] >= 5 and npc_progress['serpis_prince_first'] ! 2: faction_fame['serpis'] = 4
IF faction_fame['taurus'] >= 5 and npc_progress['taurus_king'] ! 2: faction_fame['taurus'] = 4
IF faction_fame['kamira'] >= 5 and npc_progress['tiamath'] ! 2: faction_fame['kamira'] = 4
IF faction_fame['korvus'] >= 5 and npc_progress['korvus_knyaz'] ! 2: faction_fame['korvus'] = 4

!Testing code - crushboss
IF cheat_k = 1 or cheat_h = 1 or cheat_j = 1:
 slave['reabilitation'] = 0
 assistant['reabilitation'] = 0
END
!End of testing code - crushboss

--- $newloc ---------------------------------

