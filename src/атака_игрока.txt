# атака_игрока
!THIS LOCATION CALCULATES PLAYERS ATTACKS
!Overhauled by crushboss

!Reset vars - crushboss
killvar '$спецэффект_описание'
killvar '$спецэффект_суперудара'
atk = 0
def = текущий
это_суперудар = 0
$действия_игрока = ''
супер = 0
$атака[0] = ''

!Calcuate player attacks
IF args = 1:
 $атака[0] = $атака_1_тип[$оружие]
 $рассчетный_тип_вреда = $тип_вреда[$оружие]
 вред_на_рассчет = базовый_вред[$оружие]
 $действия_игрока += '<<$атака_1_текст[$оружие]>>'
END

IF args = 2:
 $атака[0] = $атака_2_тип[$оружие]
 $рассчетный_тип_вреда = $тип_вреда[$оружие]
 вред_на_рассчет = базовый_вред[$оружие]
 $действия_игрока += '<<$атака_2_текст[$оружие]>>' 
END

IF args = 31:
 $атака[0] = $вторичная_атака_тип[$вторичный]
 $рассчетный_тип_вреда = $тип_вреда[$вторичный]
 вред_на_рассчет = базовый_вред[$вторичный]
 $наложение = '<<$вторичная_атака_бонус[$вторичный]>>'
 длительность = вторичная_атака_длительность[$вторичный]
 $наложение = '<<$вторичная_атака_штраф[$вторичный]>>'
 $действия_игрока += '<<$вторичная_атака_текст[$вторичный]>>'
END

IF args = 11:
 $атака[0] = 'сильная'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = base_str
 $действия_игрока += "You kick <<$склонение_врага[текущий]>> <font color='red'>with all of your strength</font> in the stomach"
END
IF args = 12:
 $атака[0] = 'быстрая'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = base_str
 $действия_игрока += "<font color='green'>Swift</font> push makes <<$склонение_врага[текущий]>> to falter"
END
IF args = 13:
 $атака[0] = 'точная'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = base_str
 $действия_игрока += "You make a sweep <font color='purple'>just in time</font>"
END

IF args = 29 or args = 30:
 супер = args - 20
 $атака[0] =  $суперудар_тип[$суперудар[супер]]
 $рассчетный_тип_вреда = $тип_вреда[$суперудар[супер]]
 вред_на_рассчет = базовый_вред[$суперудар[супер]]
 $действия_игрока += $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Bug fix for special modifiers not occurring on the enemy - crushboss
!Bug fix for special techniques not appearing properly - crushboss

!Roundhouse kick ['удар_с_разворота']
IF args = 21:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]
 $тип_вреда[$суперудар[супер]] = $тип_вреда[$оружие]
 $суперудар_тип[$суперудар[супер]] = 'сильная'
 $суперудар_название[$суперудар[супер]] = "<font color='red'>Roundhouse Kick</font>"
 суперудар_длительность[$суперудар[супер]] = 2+сила
 $суперудар_текст[$суперудар[супер]] = "You deal a <font color='red'>powerful</font> Roundhouse Kick"
 $спецэффект_описание[$суперудар[супер]] = 'roundhouse kick'
 $суперудар_условие_1[$суперудар[супер]] = 'нет'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {}
 $атака[0] = 'сильная'
 $рассчетный_тип_вреда = $тип_вреда[$оружие]
 вред_на_рассчет = базовый_вред[$оружие]
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1 
END

!Swift blow ['рассечение']
IF args = 22:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'рубящий'
 $суперудар_тип[$суперудар[супер]] = 'быстрая'
 $суперудар_название[$суперудар[супер]] = "<font color='green'>Swift Blow</font>"
 суперудар_длительность[$суперудар[супер]] = 2+ловкость
 $суперудар_текст[$суперудар[супер]] = "Your <font color='green'>swift</font> blow damages two enemy at once"
 $спецэффект_описание[$суперудар[супер]] = 'two targets'
 $суперудар_условие_1[$суперудар[супер]] = 'рубящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'

 $спецэффект_суперудара[$суперудар[супер]] = {
вторцель = 0
:in_loop

IF вторцель < количество_врагов:
 вторцель += 1
 IF вторцель ! текущий:
  if враг[вторцель] = 1: jump 'in_loop1'
 END
 jump 'in_loop'
END
:in_loop1

atk = 0
def = вторцель

вред_на_рассчет = базовый_вред[$оружие]*2
$атака = 'быстрая'

gs 'рассчет_вреда'

IF $класс_врага[вторцель] = 'пешка':
 IF модификатор > 0:
  $состояние[вторцель] = 'повержен'
  дух_игрока += 2
 END
END

IF $класс_врага[вторцель] ! 'пешка':
 IF $тип_нанесенного_вреда = 'психический': 
  if тонкое_тело[$враг[вторцель]] = 1: здоровье_врага[вторцель] -= нанесенный_вред 
  if бесстрашный[$враг[вторцель]] = 0: дух_врага[вторцель] -= нанесенный_вред
  дух_игрока += нанесенный_вред/2
 END 
 IF $тип_нанесенного_вреда = 'дробящий': 
  if хрупкий[$враг[вторцель]] = 1: здоровье_врага[вторцель] -= нанесенный_вред 
  if безустали[$враг[вторцель]] = 0: выносливость_врага[вторцель] -= нанесенный_вред 
  if бесстрашный[$враг[вторцель]] = 0: дух_врага[вторцель] -= нанесенный_вред
  дух_игрока += нанесенный_вред/2
 END
 if бессмертный[$враг[текущий]] = 0: здоровье_врага[вторцель] -= нанесенный_вред 
 if безустали[$враг[текущий]] = 0: выносливость_врага[вторцель] -= нанесенный_вред 
 if бесстрашный[$враг[текущий]] = 0: дух_врага[вторцель] -= нанесенный_вред
 дух_игрока += нанесенный_вред[i]/2
END
}
 $атака[0] = 'быстрая'
 $рассчетный_тип_вреда = 'рубящий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Battle cry ['воинственный_клич']
IF args = 23:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = 10
 $тип_вреда[$суперудар[супер]] = 'психический'
 $суперудар_тип[$суперудар[супер]] = 'точная'
 $суперудар_название[$суперудар[супер]] = "<font color='purple'>Battle Cry</font>"
 суперудар_длительность[$суперудар[супер]] = 2+восприятие
 $суперудар_текст[$суперудар[супер]] = "You shout a <font color='purple'>chilling</font> roar, that inspires fear in the hearts of enemies and gives you a burst of energy"
 $спецэффект_описание[$суперудар[супер]] = 'psy attack'
 $суперудар_условие_1[$суперудар[супер]] = 'нет'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'

 $спецэффект_суперудара[$суперудар[супер]] = {
if бешенство < 4: бешенство = 4
дух_игрока += 20
} 
 $атака[0] = 'точная'
 $рассчетный_тип_вреда = 'психический'
 вред_на_рассчет = 10
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Heavy blow ['оглушение']
IF args = 24:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'дробящий'
 $суперудар_тип[$суперудар[супер]] = 'сильная'
 $суперудар_название[$суперудар[супер]] = "<font color='red'>Heavy Blow</font>"
 суперудар_длительность[$суперудар[супер]] = 2+сила
 $суперудар_текст[$суперудар[супер]] = "You put all your <font color='red'>strength</font> in a blow to the head of the enemy"
 $спецэффект_описание[$суперудар[супер]] = 'stun'
 $суперудар_условие_1[$суперудар[супер]] = 'дробящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует' 
 $спецэффект_суперудара[$суперудар[супер]] = {
ошеломление[текущий] = 4 
}
 $атака[0] = 'сильная'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Precise hit ['ослепление']
IF args = 25:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'колющий'
 $суперудар_тип[$суперудар[супер]] = 'точная'
 $суперудар_название[$суперудар[супер]] = "<font color='purple'>Precise Hit</font>"
 суперудар_длительность[$суперудар[супер]] = 2+восприятие
 $суперудар_текст[$суперудар[супер]] = "You hit <font color='purple'>precisely</font> in the eyes to bring down the enemy as they are blinded"
 $спецэффект_описание[$суперудар[супер]] = 'blinding'
 $суперудар_условие_1[$суперудар[супер]] = 'колющий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует' 
 $спецэффект_суперудара[$суперудар[супер]] = {
рассеянность[текущий] = 4
}
 $атака[0] = 'точная'
 $рассчетный_тип_вреда = 'колющий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Dashing blow ['подрезка']
IF args = 26:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'рубящий'
 $суперудар_тип[$суперудар[супер]] = 'точная'
 $суперудар_название[$суперудар[супер]] = "<font color='green'>Dashing Blow</font>"
 суперудар_длительность[$суперудар[супер]] = 2+ловкость
 $суперудар_текст[$суперудар[супер]] = "You quickly <font color='green'>cut</font> the enemies tendons, so now it will be hard for them to stay on their feet"
 $спецэффект_описание[$суперудар[супер]] = 'cutting'
 $суперудар_условие_1[$суперудар[супер]] = 'рубящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует' 
 $спецэффект_суперудара[$суперудар[супер]] = {
шаткость[текущий] = 4
} 
 $атака[0] =  'точная'
 $рассчетный_тип_вреда = 'рубящий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = "You quickly <font color='green'>cut</font> the enemies tendons, so now it will be hard for them to stay on their feet" 
 это_суперудар = 1
END

!Riposte ['ответный_удар']
IF args = 27:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'колющий'
 $суперудар_тип[$суперудар[супер]] = 'точная'
 $суперудар_название[$суперудар[супер]] = "<font color='purple'>Riposte</font>"
 суперудар_длительность[$суперудар[супер]] = 2+восприятие
 $суперудар_текст[$суперудар[супер]] = "You parry <font color='purple'>precisely</font> as you make a quick piercing blow to the enemies vitals"
 $спецэффект_описание[$суперудар[супер]] = 'evasion and piercing'
 $суперудар_условие_1[$суперудар[супер]] = 'колющий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {
if верткость < 4: верткость = 4
здоровье_игрока += 5
} 
 $атака[0] = 'точная'
 $рассчетный_тип_вреда = 'колющий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Face Butt ['лицо_прикладом']
IF args = 28:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'дробящий'
 $суперудар_тип[$суперудар[супер]] = 'сильная'
 $суперудар_название[$суперудар[супер]] = "<font color='red'>Face Butt</font>"
 суперудар_длительность[$суперудар[супер]] = 2+сила
 $суперудар_текст[$суперудар[супер]] = "You fake a low attack and lower the enemies defenses.  You quickly and <font color='red'>powerfully</font> smash your blunt weapon forward into the enemies face"
 $спецэффект_описание[$суперудар[супер]] = 'power and weakness'
 $суперудар_условие_1[$суперудар[супер]] = 'дробящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {
слабость[текущий] = 4
}
 $атака[0] = 'сильная'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!THROW A NET ['бросок_сети']
IF args = 32:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = 5
 $тип_вреда[$суперудар[супер]] = 'дробящий'
 $суперудар_тип[$суперудар[супер]] = 'быстрая'
 $суперудар_название[$суперудар[супер]] = "<font color='red'>THROW NET</font>"
 суперудар_длительность[$суперудар[супер]] = 10+ловкость
 $суперудар_текст[$суперудар[супер]] = "You throw your net at the enemy <font color='purple'>just in time</font>. Now she is almost helpless!"
 $спецэффект_описание[$суперудар[супер]] = 'entangled'
 $суперудар_условие_1[$суперудар[супер]] = 'дробящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {
скованность[текущий] = 8
слабость[текущий] = 8
рассеянность[текущий] = 8
}
 $атака[0] = 'быстрая'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = 5
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END 

!Serrated blade ['серейтор']
IF args = 33:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'рубящий'
 $суперудар_тип[$суперудар[супер]] = 'быстрая'
 $суперудар_название[$суперудар[супер]] = "<font color='red'>Serrated Blade</font>"
 суперудар_длительность[$суперудар[супер]] = 2+сила
 $суперудар_текст[$суперудар[супер]] = "You <font color='green'>cut</font> your opponent with a whipsaw and pull it back, tearing flesh of your miserable enemy"
 $спецэффект_описание[$суперудар[супер]] = 'terrible scar'
 $суперудар_условие_1[$суперудар[супер]] = 'рубящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {
боль[текущий] = 8
}
 $атака[0] = 'быстрая'
 $рассчетный_тип_вреда = 'рубящий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!SCISSORS ['ножницы']
IF args = 34:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*3
 $тип_вреда[$суперудар[супер]] = 'рубящий'
 $суперудар_тип[$суперудар[супер]] = 'быстрая'
 $суперудар_название[$суперудар[супер]] = "<font color='green'>Scissors</font>"
 суперудар_длительность[$суперудар[супер]] = 2+сила
 $суперудар_текст[$суперудар[супер]] = "You take your swords like a huge deadly <font color='green'>scissors</font> and hit your enemy with it"
 $спецэффект_описание[$суперудар[супер]] = 'a lot of damage'
 $суперудар_условие_1[$суперудар[супер]] = 'рубящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {}
 $атака[0] = 'быстрая'
 $рассчетный_тип_вреда = 'рубящий'
 вред_на_рассчет = базовый_вред[$оружие]*3
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!SHIELD BASH ['толчок_щитом']
IF args = 35:
 супер = args - 20
 базовый_вред[$суперудар[супер]] = базовый_вред[$оружие]*2
 $тип_вреда[$суперудар[супер]] = 'дробящий'
 $суперудар_тип[$суперудар[супер]] = 'сильная'
 $суперудар_название[$суперудар[супер]] = "<font color='red'>Shield Bash</font>"
 суперудар_длительность[$суперудар[супер]] = 2+сила
 $суперудар_текст[$суперудар[супер]] = "You <font color='red'>bash</font> your enemy with a shield, causing her to falter"
 $спецэффект_описание[$суперудар[супер]] = 'knocked down'
 $суперудар_условие_1[$суперудар[супер]] = 'дробящий'
 $суперудар_условие_2[$суперудар[супер]] = 'нет'
 $суперудар_условие_против[$суперудар[супер]] = 'отсутствует'
 $спецэффект_суперудара[$суперудар[супер]] = {
рассеянность[текущий] = 8
ошеломление[текущий] = 8
}
 $атака[0] = 'сильная'
 $рассчетный_тип_вреда = 'дробящий'
 вред_на_рассчет = базовый_вред[$оружие]*2
 $действия_игрока = $суперудар_текст[$суперудар[супер]] 
 это_суперудар = 1
END

!Debug message for troubleshooting - crushboss
! msg '$ataka[0]: <<$атака[0]>><br>$рассчетный_тип_вреда: <<$рассчетный_тип_вреда>><br>вред_на_рассчет: <<вред_на_рассчет>><br>$действия_игрока: <<$действия_игрока>><br>'

gs 'рассчет_вреда'

IF $класс_врага[текущий] = 'пешка':
 IF модификатор > 0:
  $состояние[текущий] = 'повержен'
  дух_игрока += 2
  $действия_игрока += " [fatal blow]"  
  else
  $действия_игрока += " [miss]"
 END
 jump 'loop9'
END

$действия_игрока += " [<<нанесенный_вред>>] "

IF $эффект = 'удвоение': 
 наложение = 0 
 $наложение = 'удвоение вреда'
END

IF это_суперудар = 1: 
 if наложение = 0: $действия_игрока += "[doubled]"
 $действия_игрока += " (<<$спецэффект_описание[$суперудар[супер]]>>)<br>" 
 jump 'loop10'
END

:loop9
IF $эффект = 'бонус': 
 наложение = 1 
 IF args = 1: 
  $наложение = '<<$атака_1_бонус[$оружие]>>' 
  длительность = атака_1_длительность[$оружие]
 END
 IF args = 2: 
  $наложение = '<<$атака_2_бонус[$оружие]>>' 
  длительность = атака_2_длительность[$оружие]
 END
 IF args = 11: 
  $наложение = 'внимание' 
  длительность = 2
 END
 IF args = 12: 
  $наложение = 'адреналин' 
  длительность = 2
 END
 IF args = 13: 
  $наложение = 'верткость' 
  длительность = 2
 END 
 IF args = 31:
  $наложение = '<<$вторичная_атака_бонус[$вторичный]>>' 
  длительность = вторичная_атака_длительность[$вторичный]
 END 
END

IF $эффект = 'штраф': 
 наложение = 2 
 IF args = 1: 
  $наложение = '<<$атака_1_штраф[$оружие]>>' 
  длительность = атака_1_длительность[$оружие]
 END  
 IF args = 2: 
  $наложение = '<<$атака_2_штраф[$оружие]>>' 
  длительность = атака_2_длительность[$оружие]
 END  
 IF args = 11: 
  $наложение = 'ошеломление' 
  длительность = 2
 END  
 IF args = 12: 
  $наложение = 'рассеянность' 
  длительность = 2
 END 
 IF args = 13: 
  $наложение = 'шаткость' 
  длительность = 2
 END   
 IF args = 31:
  $наложение = '<<$вторичная_атака_штраф[$вторичный]>>'
  длительность = вторичная_атака_длительность[$вторичный]
 END   
END

IF $наложение = 'удвоение вреда':
 $действия_игрока += "[doubled]<br>"
END

!status inflict translation
if $наложение = 'слабость': $действия_игрока += "[<font color='red'>weakness</font>]<br>"
if $наложение = 'шаткость': $действия_игрока += "[<font color='red'>unsteadiness</font>]<br>"
if $наложение = 'бешенство': $действия_игрока += "[<font color='red'>fury</font>]<br>"
if $наложение = 'адреналин': $действия_игрока += "[<font color='red'>adrenaline</font>]<br>"

if $наложение = 'скованность': $действия_игрока += "[<font color='green'>stiffness</font>]<br>"
if $наложение = 'ошеломление': $действия_игрока += "[<font color='green'>stunned</font>]<br>"
if $наложение = 'разгон': $действия_игрока += "[<font color='green'>acceleration</font>]<br>"
if $наложение = 'верткость': $действия_игрока += "[<font color='green'>evasion</font>]<br>"

if $наложение = 'боль': $действия_игрока += "[<font color='purple'>pain</font>]<br>"
if $наложение = 'рассеянность': $действия_игрока += "[<font color='purple'>distraction</font>]<br>"
if $наложение = 'меткость': $действия_игрока += "[<font color='purple'>precision</font>]<br>"
if $наложение = 'внимание': $действия_игрока += "[<font color='purple'>attention</font>]<br>"

:loop10
GT 'ход_противников'
--- атака_игрока ---------------------------------

